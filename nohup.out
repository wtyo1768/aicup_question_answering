2021-06-17 00:57:22.141744: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
WARNING: features.msgpack does not exist, try loading features.pkl
Building prefix dict from the default dictionary ...
Loading model from cache /tmp/jieba.cache
Loading model cost 0.384 seconds.
Prefix dict has been built successfully.
2021-06-17 00:58:22.341891: I tensorflow/stream_executor/platform/default/dso_loader.cc:53] Successfully opened dynamic library libcudart.so.11.0
WARNING: features.msgpack does not exist, try loading features.pkl
Building prefix dict from the default dictionary ...
Loading model from cache /tmp/jieba.cache
Loading model cost 0.383 seconds.
Prefix dict has been built successfully.
/home/rockyo/anaconda3/envs/aicup/lib/python3.7/site-packages/fastNLP/embeddings/bert_embedding.py:430: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  self.word_to_wordpieces = np.array(word_to_wordpieces)
  0%|          | 0/432 [00:00<?, ?it/s, loss:{0:<6.5f}]Epoch 1/12:   0%|          | 0/432 [00:00<?, ?it/s, loss:{0:<6.5f}]Epoch 1/12:   1%|          | 5/432 [00:00<00:42,  9.97it/s, loss:{0:<6.5f}]Epoch 1/12:   1%|          | 5/432 [00:00<00:42,  9.97it/s, loss:2.03050]  Epoch 1/12:   2%|▏         | 10/432 [00:01<00:42,  9.85it/s, loss:2.03050]Epoch 1/12:   2%|▏         | 10/432 [00:01<00:42,  9.85it/s, loss:1.91723]Epoch 1/12:   3%|▎         | 15/432 [00:01<00:41,  9.96it/s, loss:1.91723]Epoch 1/12:   3%|▎         | 15/432 [00:01<00:41,  9.96it/s, loss:1.92069]Epoch 1/12:   5%|▍         | 20/432 [00:02<00:41,  9.96it/s, loss:1.92069]Epoch 1/12:   5%|▍         | 20/432 [00:02<00:41,  9.96it/s, loss:1.90386]Epoch 1/12:   6%|▌         | 25/432 [00:02<00:41,  9.81it/s, loss:1.90386]Epoch 1/12:   6%|▌         | 25/432 [00:02<00:41,  9.81it/s, loss:1.90500]Epoch 1/12:   7%|▋         | 30/432 [00:03<00:40,  9.96it/s, loss:1.90500]Epoch 1/12:   7%|▋         | 30/432 [00:03<00:40,  9.96it/s, loss:1.91535]Epoch 1/12:   8%|▊         | 35/432 [00:03<00:39,  9.96it/s, loss:1.91535]Epoch 1/12:   8%|▊         | 35/432 [00:03<00:39,  9.96it/s, loss:1.90141]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.47it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.60it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.18it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.33it/s][A
                                                   [A                                                                          Epoch 1/12:   8%|▊         | 35/432 [00:03<00:39,  9.96it/s, loss:1.90141]                                                                          Epoch 1/12:   8%|▊         | 35/432 [00:04<00:39,  9.96it/s, loss:1.90141]                                                                          Epoch 1/12:   8%|▊         | 35/432 [00:04<00:39,  9.96it/s, loss:1.90141]/home/rockyo/anaconda3/envs/aicup/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:154: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch 2/12:   8%|▊         | 35/432 [00:04<00:39,  9.96it/s, loss:1.90141]Epoch 2/12:   9%|▉         | 40/432 [00:04<00:53,  7.39it/s, loss:1.90141]Epoch 2/12:   9%|▉         | 40/432 [00:04<00:53,  7.39it/s, loss:1.87668]Epoch 2/12:  10%|█         | 45/432 [00:05<00:48,  8.00it/s, loss:1.87668]Epoch 2/12:  10%|█         | 45/432 [00:05<00:48,  8.00it/s, loss:1.86442]Epoch 2/12:  12%|█▏        | 50/432 [00:05<00:44,  8.53it/s, loss:1.86442]Epoch 2/12:  12%|█▏        | 50/432 [00:05<00:44,  8.53it/s, loss:1.85257]Epoch 2/12:  13%|█▎        | 55/432 [00:06<00:42,  8.90it/s, loss:1.85257]Epoch 2/12:  13%|█▎        | 55/432 [00:06<00:42,  8.90it/s, loss:1.86197]Epoch 2/12:  14%|█▍        | 60/432 [00:06<00:40,  9.21it/s, loss:1.86197]Epoch 2/12:  14%|█▍        | 60/432 [00:06<00:40,  9.21it/s, loss:1.89586]Epoch 2/12:  15%|█▌        | 65/432 [00:07<00:39,  9.30it/s, loss:1.89586]Epoch 2/12:  15%|█▌        | 65/432 [00:07<00:39,  9.30it/s, loss:1.93362]Epoch 2/12:  16%|█▌        | 70/432 [00:07<00:37,  9.56it/s, loss:1.93362]Epoch 2/12:  16%|█▌        | 70/432 [00:07<00:37,  9.56it/s, loss:1.88260]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.32it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.53it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.24it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.49it/s][A
                                                   [A                                                                          Epoch 2/12:  16%|█▌        | 70/432 [00:08<00:37,  9.56it/s, loss:1.88260]                                                                          Epoch 2/12:  16%|█▌        | 70/432 [00:08<00:37,  9.56it/s, loss:1.88260]                                                                          Epoch 2/12:  16%|█▌        | 70/432 [00:08<00:37,  9.56it/s, loss:1.88260]Epoch 3/12:  16%|█▌        | 70/432 [00:08<00:37,  9.56it/s, loss:1.88260]Epoch 3/12:  17%|█▋        | 75/432 [00:08<00:44,  8.01it/s, loss:1.88260]Epoch 3/12:  17%|█▋        | 75/432 [00:08<00:44,  8.01it/s, loss:1.88865]Epoch 3/12:  19%|█▊        | 80/432 [00:08<00:41,  8.49it/s, loss:1.88865]Epoch 3/12:  19%|█▊        | 80/432 [00:08<00:41,  8.49it/s, loss:1.88630]Epoch 3/12:  20%|█▉        | 85/432 [00:09<00:39,  8.84it/s, loss:1.88630]Epoch 3/12:  20%|█▉        | 85/432 [00:09<00:39,  8.84it/s, loss:1.84839]Epoch 3/12:  21%|██        | 90/432 [00:09<00:37,  9.15it/s, loss:1.84839]Epoch 3/12:  21%|██        | 90/432 [00:09<00:37,  9.15it/s, loss:1.84371]Epoch 3/12:  22%|██▏       | 95/432 [00:10<00:36,  9.33it/s, loss:1.84371]Epoch 3/12:  22%|██▏       | 95/432 [00:10<00:36,  9.33it/s, loss:1.87108]Epoch 3/12:  23%|██▎       | 100/432 [00:11<00:34,  9.50it/s, loss:1.87108]Epoch 3/12:  23%|██▎       | 100/432 [00:11<00:34,  9.50it/s, loss:1.80522]Epoch 3/12:  24%|██▍       | 105/432 [00:11<00:34,  9.58it/s, loss:1.80522]Epoch 3/12:  24%|██▍       | 105/432 [00:11<00:34,  9.58it/s, loss:1.76507]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.40it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.53it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.18it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.42it/s][A
                                                   [A                                                                           Epoch 3/12:  24%|██▍       | 105/432 [00:12<00:34,  9.58it/s, loss:1.76507]                                                                           Epoch 3/12:  24%|██▍       | 105/432 [00:12<00:34,  9.58it/s, loss:1.76507]                                                                           Epoch 3/12:  24%|██▍       | 105/432 [00:12<00:34,  9.58it/s, loss:1.76507]Epoch 4/12:  24%|██▍       | 105/432 [00:12<00:34,  9.58it/s, loss:1.76507]Epoch 4/12:  25%|██▌       | 110/432 [00:12<00:44,  7.25it/s, loss:1.76507]Epoch 4/12:  25%|██▌       | 110/432 [00:12<00:44,  7.25it/s, loss:1.74150]Epoch 4/12:  27%|██▋       | 115/432 [00:13<00:40,  7.85it/s, loss:1.74150]Epoch 4/12:  27%|██▋       | 115/432 [00:13<00:40,  7.85it/s, loss:1.78115]Epoch 4/12:  28%|██▊       | 120/432 [00:13<00:37,  8.39it/s, loss:1.78115]Epoch 4/12:  28%|██▊       | 120/432 [00:13<00:37,  8.39it/s, loss:1.86568]Epoch 4/12:  29%|██▉       | 125/432 [00:14<00:34,  8.86it/s, loss:1.86568]Epoch 4/12:  29%|██▉       | 125/432 [00:14<00:34,  8.86it/s, loss:1.89397]Epoch 4/12:  30%|███       | 130/432 [00:14<00:33,  9.08it/s, loss:1.89397]Epoch 4/12:  30%|███       | 130/432 [00:14<00:33,  9.08it/s, loss:1.84877]Epoch 4/12:  31%|███▏      | 135/432 [00:15<00:31,  9.33it/s, loss:1.84877]Epoch 4/12:  31%|███▏      | 135/432 [00:15<00:31,  9.33it/s, loss:1.66940]Epoch 4/12:  32%|███▏      | 140/432 [00:15<00:30,  9.48it/s, loss:1.66940]Epoch 4/12:  32%|███▏      | 140/432 [00:15<00:30,  9.48it/s, loss:1.86001]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.32it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.55it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.23it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.43it/s][A
                                                   [A                                                                           Epoch 4/12:  32%|███▏      | 140/432 [00:16<00:30,  9.48it/s, loss:1.86001]                                                                           Epoch 4/12:  32%|███▏      | 140/432 [00:16<00:30,  9.48it/s, loss:1.86001]                                                                           Epoch 4/12:  32%|███▏      | 140/432 [00:16<00:30,  9.48it/s, loss:1.86001]Epoch 5/12:  32%|███▏      | 140/432 [00:16<00:30,  9.48it/s, loss:1.86001]Epoch 5/12:  34%|███▎      | 145/432 [00:16<00:39,  7.28it/s, loss:1.86001]Epoch 5/12:  34%|███▎      | 145/432 [00:16<00:39,  7.28it/s, loss:1.82739]Epoch 5/12:  35%|███▍      | 150/432 [00:17<00:35,  7.91it/s, loss:1.82739]Epoch 5/12:  35%|███▍      | 150/432 [00:17<00:35,  7.91it/s, loss:1.66389]Epoch 5/12:  36%|███▌      | 155/432 [00:17<00:33,  8.36it/s, loss:1.66389]Epoch 5/12:  36%|███▌      | 155/432 [00:17<00:33,  8.36it/s, loss:1.67073]Epoch 5/12:  37%|███▋      | 160/432 [00:18<00:31,  8.73it/s, loss:1.67073]Epoch 5/12:  37%|███▋      | 160/432 [00:18<00:31,  8.73it/s, loss:1.65890]Epoch 5/12:  38%|███▊      | 165/432 [00:18<00:29,  9.00it/s, loss:1.65890]Epoch 5/12:  38%|███▊      | 165/432 [00:18<00:29,  9.00it/s, loss:1.77971]Epoch 5/12:  39%|███▉      | 170/432 [00:19<00:28,  9.27it/s, loss:1.77971]Epoch 5/12:  39%|███▉      | 170/432 [00:19<00:28,  9.27it/s, loss:1.93111]Epoch 5/12:  41%|████      | 175/432 [00:19<00:27,  9.50it/s, loss:1.93111]Epoch 5/12:  41%|████      | 175/432 [00:19<00:27,  9.50it/s, loss:1.81410]Epoch 5/12:  42%|████▏     | 180/432 [00:20<00:25,  9.99it/s, loss:1.81410]Epoch 5/12:  42%|████▏     | 180/432 [00:20<00:25,  9.99it/s, loss:1.88631]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.35it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.57it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.23it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.44it/s][A
                                                   [A                                                                           Epoch 5/12:  42%|████▏     | 180/432 [00:20<00:25,  9.99it/s, loss:1.88631]                                                                           Epoch 5/12:  42%|████▏     | 180/432 [00:20<00:25,  9.99it/s, loss:1.88631]                                                                           Epoch 5/12:  42%|████▏     | 180/432 [00:20<00:25,  9.99it/s, loss:1.88631]Epoch 6/12:  42%|████▏     | 180/432 [00:20<00:25,  9.99it/s, loss:1.88631]Epoch 6/12:  43%|████▎     | 185/432 [00:21<00:31,  7.89it/s, loss:1.88631]Epoch 6/12:  43%|████▎     | 185/432 [00:21<00:31,  7.89it/s, loss:1.75833]Epoch 6/12:  44%|████▍     | 190/432 [00:21<00:28,  8.40it/s, loss:1.75833]Epoch 6/12:  44%|████▍     | 190/432 [00:21<00:28,  8.40it/s, loss:1.72569]Epoch 6/12:  45%|████▌     | 195/432 [00:22<00:27,  8.76it/s, loss:1.72569]Epoch 6/12:  45%|████▌     | 195/432 [00:22<00:27,  8.76it/s, loss:1.68123]Epoch 6/12:  46%|████▋     | 200/432 [00:22<00:25,  9.07it/s, loss:1.68123]Epoch 6/12:  46%|████▋     | 200/432 [00:22<00:25,  9.07it/s, loss:1.61327]Epoch 6/12:  47%|████▋     | 205/432 [00:23<00:24,  9.25it/s, loss:1.61327]Epoch 6/12:  47%|████▋     | 205/432 [00:23<00:24,  9.25it/s, loss:1.66549]Epoch 6/12:  49%|████▊     | 210/432 [00:23<00:23,  9.45it/s, loss:1.66549]Epoch 6/12:  49%|████▊     | 210/432 [00:23<00:23,  9.45it/s, loss:1.84350]Epoch 6/12:  50%|████▉     | 215/432 [00:24<00:22,  9.57it/s, loss:1.84350]Epoch 6/12:  50%|████▉     | 215/432 [00:24<00:22,  9.57it/s, loss:1.83825]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.37it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.55it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.21it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.44it/s][A
                                                   [A                                                                           Epoch 6/12:  50%|████▉     | 215/432 [00:24<00:22,  9.57it/s, loss:1.83825]                                                                           Epoch 6/12:  50%|████▉     | 215/432 [00:24<00:22,  9.57it/s, loss:1.83825]                                                                           Epoch 6/12:  50%|████▉     | 215/432 [00:24<00:22,  9.57it/s, loss:1.83825]Epoch 7/12:  50%|████▉     | 215/432 [00:24<00:22,  9.57it/s, loss:1.83825]Epoch 7/12:  51%|█████     | 220/432 [00:25<00:26,  7.96it/s, loss:1.83825]Epoch 7/12:  51%|█████     | 220/432 [00:25<00:26,  7.96it/s, loss:1.72086]Epoch 7/12:  52%|█████▏    | 225/432 [00:25<00:24,  8.45it/s, loss:1.72086]Epoch 7/12:  52%|█████▏    | 225/432 [00:25<00:24,  8.45it/s, loss:1.68723]Epoch 7/12:  53%|█████▎    | 230/432 [00:26<00:22,  8.86it/s, loss:1.68723]Epoch 7/12:  53%|█████▎    | 230/432 [00:26<00:22,  8.86it/s, loss:1.63702]Epoch 7/12:  54%|█████▍    | 235/432 [00:26<00:21,  9.15it/s, loss:1.63702]Epoch 7/12:  54%|█████▍    | 235/432 [00:26<00:21,  9.15it/s, loss:1.69617]Epoch 7/12:  56%|█████▌    | 240/432 [00:27<00:20,  9.38it/s, loss:1.69617]Epoch 7/12:  56%|█████▌    | 240/432 [00:27<00:20,  9.38it/s, loss:1.71925]Epoch 7/12:  57%|█████▋    | 245/432 [00:27<00:19,  9.45it/s, loss:1.71925]Epoch 7/12:  57%|█████▋    | 245/432 [00:27<00:19,  9.45it/s, loss:1.57763]Epoch 7/12:  58%|█████▊    | 250/432 [00:28<00:19,  9.57it/s, loss:1.57763]Epoch 7/12:  58%|█████▊    | 250/432 [00:28<00:19,  9.57it/s, loss:1.75864]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.26it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.48it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.15it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.37it/s][A
                                                   [A                                                                           Epoch 7/12:  58%|█████▊    | 250/432 [00:28<00:19,  9.57it/s, loss:1.75864]                                                                           Epoch 7/12:  58%|█████▊    | 250/432 [00:28<00:19,  9.57it/s, loss:1.75864]                                                                           Epoch 7/12:  58%|█████▊    | 250/432 [00:28<00:19,  9.57it/s, loss:1.75864]Epoch 8/12:  58%|█████▊    | 250/432 [00:28<00:19,  9.57it/s, loss:1.75864]Epoch 8/12:  59%|█████▉    | 255/432 [00:29<00:24,  7.37it/s, loss:1.75864]Epoch 8/12:  59%|█████▉    | 255/432 [00:29<00:24,  7.37it/s, loss:1.52736]Epoch 8/12:  60%|██████    | 260/432 [00:29<00:21,  7.88it/s, loss:1.52736]Epoch 8/12:  60%|██████    | 260/432 [00:29<00:21,  7.88it/s, loss:1.69897]Epoch 8/12:  61%|██████▏   | 265/432 [00:30<00:19,  8.44it/s, loss:1.69897]Epoch 8/12:  61%|██████▏   | 265/432 [00:30<00:19,  8.44it/s, loss:1.51510]Epoch 8/12:  62%|██████▎   | 270/432 [00:30<00:18,  8.87it/s, loss:1.51510]Epoch 8/12:  62%|██████▎   | 270/432 [00:30<00:18,  8.87it/s, loss:1.64066]Epoch 8/12:  64%|██████▎   | 275/432 [00:31<00:17,  9.16it/s, loss:1.64066]Epoch 8/12:  64%|██████▎   | 275/432 [00:31<00:17,  9.16it/s, loss:1.54104]Epoch 8/12:  65%|██████▍   | 280/432 [00:31<00:16,  9.34it/s, loss:1.54104]Epoch 8/12:  65%|██████▍   | 280/432 [00:31<00:16,  9.34it/s, loss:1.41023]Epoch 8/12:  66%|██████▌   | 285/432 [00:32<00:15,  9.47it/s, loss:1.41023]Epoch 8/12:  66%|██████▌   | 285/432 [00:32<00:15,  9.47it/s, loss:1.77661]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.13it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.18it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 18.81it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.07it/s][A
                                                   [A                                                                           Epoch 8/12:  66%|██████▌   | 285/432 [00:32<00:15,  9.47it/s, loss:1.77661]                                                                           Epoch 8/12:  66%|██████▌   | 285/432 [00:32<00:15,  9.47it/s, loss:1.77661]                                                                           Epoch 8/12:  66%|██████▌   | 285/432 [00:32<00:15,  9.47it/s, loss:1.77661]Epoch 9/12:  66%|██████▌   | 285/432 [00:32<00:15,  9.47it/s, loss:1.77661]Epoch 9/12:  67%|██████▋   | 290/432 [00:33<00:17,  7.92it/s, loss:1.77661]Epoch 9/12:  67%|██████▋   | 290/432 [00:33<00:17,  7.92it/s, loss:1.57042]Epoch 9/12:  68%|██████▊   | 295/432 [00:33<00:16,  8.37it/s, loss:1.57042]Epoch 9/12:  68%|██████▊   | 295/432 [00:33<00:16,  8.37it/s, loss:1.56718]Epoch 9/12:  69%|██████▉   | 300/432 [00:34<00:15,  8.74it/s, loss:1.56718]Epoch 9/12:  69%|██████▉   | 300/432 [00:34<00:15,  8.74it/s, loss:1.68355]Epoch 9/12:  71%|███████   | 305/432 [00:34<00:14,  9.06it/s, loss:1.68355]Epoch 9/12:  71%|███████   | 305/432 [00:34<00:14,  9.06it/s, loss:1.61556]Epoch 9/12:  72%|███████▏  | 310/432 [00:35<00:13,  9.29it/s, loss:1.61556]Epoch 9/12:  72%|███████▏  | 310/432 [00:35<00:13,  9.29it/s, loss:1.61246]Epoch 9/12:  73%|███████▎  | 315/432 [00:35<00:12,  9.42it/s, loss:1.61246]Epoch 9/12:  73%|███████▎  | 315/432 [00:35<00:12,  9.42it/s, loss:1.85034]Epoch 9/12:  74%|███████▍  | 320/432 [00:36<00:11,  9.49it/s, loss:1.85034]Epoch 9/12:  74%|███████▍  | 320/432 [00:36<00:11,  9.49it/s, loss:1.49042]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.06it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.24it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.01it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.25it/s][A
                                                   [A                                                                           Epoch 9/12:  74%|███████▍  | 320/432 [00:36<00:11,  9.49it/s, loss:1.49042]                                                                           Epoch 9/12:  74%|███████▍  | 320/432 [00:36<00:11,  9.49it/s, loss:1.49042]                                                                           Epoch 9/12:  74%|███████▍  | 320/432 [00:36<00:11,  9.49it/s, loss:1.49042]Epoch 10/12:  74%|███████▍  | 320/432 [00:36<00:11,  9.49it/s, loss:1.49042]Epoch 10/12:  75%|███████▌  | 325/432 [00:37<00:13,  7.87it/s, loss:1.49042]Epoch 10/12:  75%|███████▌  | 325/432 [00:37<00:13,  7.87it/s, loss:1.55534]Epoch 10/12:  76%|███████▋  | 330/432 [00:37<00:12,  8.38it/s, loss:1.55534]Epoch 10/12:  76%|███████▋  | 330/432 [00:37<00:12,  8.38it/s, loss:1.40047]Epoch 10/12:  78%|███████▊  | 335/432 [00:38<00:11,  8.77it/s, loss:1.40047]Epoch 10/12:  78%|███████▊  | 335/432 [00:38<00:11,  8.77it/s, loss:1.45724]Epoch 10/12:  79%|███████▊  | 340/432 [00:38<00:10,  9.09it/s, loss:1.45724]Epoch 10/12:  79%|███████▊  | 340/432 [00:38<00:10,  9.09it/s, loss:1.58915]Epoch 10/12:  80%|███████▉  | 345/432 [00:39<00:09,  9.30it/s, loss:1.58915]Epoch 10/12:  80%|███████▉  | 345/432 [00:39<00:09,  9.30it/s, loss:1.54257]Epoch 10/12:  81%|████████  | 350/432 [00:39<00:08,  9.45it/s, loss:1.54257]Epoch 10/12:  81%|████████  | 350/432 [00:39<00:08,  9.45it/s, loss:1.52618]Epoch 10/12:  82%|████████▏ | 355/432 [00:40<00:08,  9.47it/s, loss:1.52618]Epoch 10/12:  82%|████████▏ | 355/432 [00:40<00:08,  9.47it/s, loss:1.59443]Epoch 10/12:  83%|████████▎ | 360/432 [00:40<00:07,  9.84it/s, loss:1.59443]Epoch 10/12:  83%|████████▎ | 360/432 [00:40<00:07,  9.84it/s, loss:1.51027]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.20it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.43it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.13it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.35it/s][A
                                                   [A                                                                            Epoch 10/12:  83%|████████▎ | 360/432 [00:40<00:07,  9.84it/s, loss:1.51027]                                                                            Epoch 10/12:  83%|████████▎ | 360/432 [00:40<00:07,  9.84it/s, loss:1.51027]                                                                            Epoch 10/12:  83%|████████▎ | 360/432 [00:40<00:07,  9.84it/s, loss:1.51027]Epoch 11/12:  83%|████████▎ | 360/432 [00:40<00:07,  9.84it/s, loss:1.51027]Epoch 11/12:  84%|████████▍ | 365/432 [00:41<00:08,  7.81it/s, loss:1.51027]Epoch 11/12:  84%|████████▍ | 365/432 [00:41<00:08,  7.81it/s, loss:1.41439]Epoch 11/12:  86%|████████▌ | 370/432 [00:41<00:07,  8.35it/s, loss:1.41439]Epoch 11/12:  86%|████████▌ | 370/432 [00:41<00:07,  8.35it/s, loss:1.28577]Epoch 11/12:  87%|████████▋ | 375/432 [00:42<00:06,  8.73it/s, loss:1.28577]Epoch 11/12:  87%|████████▋ | 375/432 [00:42<00:06,  8.73it/s, loss:1.33002]Epoch 11/12:  88%|████████▊ | 380/432 [00:43<00:05,  9.03it/s, loss:1.33002]Epoch 11/12:  88%|████████▊ | 380/432 [00:43<00:05,  9.03it/s, loss:1.62399]Epoch 11/12:  89%|████████▉ | 385/432 [00:43<00:05,  9.25it/s, loss:1.62399]Epoch 11/12:  89%|████████▉ | 385/432 [00:43<00:05,  9.25it/s, loss:1.63240]Epoch 11/12:  90%|█████████ | 390/432 [00:44<00:04,  9.37it/s, loss:1.63240]Epoch 11/12:  90%|█████████ | 390/432 [00:44<00:04,  9.37it/s, loss:1.64966]Epoch 11/12:  91%|█████████▏| 395/432 [00:44<00:03,  9.60it/s, loss:1.64966]Epoch 11/12:  91%|█████████▏| 395/432 [00:44<00:03,  9.60it/s, loss:1.50431]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.19it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.42it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.07it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.29it/s][A
                                                   [A                                                                            Epoch 11/12:  91%|█████████▏| 395/432 [00:44<00:03,  9.60it/s, loss:1.50431]                                                                            Epoch 11/12:  91%|█████████▏| 395/432 [00:44<00:03,  9.60it/s, loss:1.50431]                                                                            Epoch 11/12:  91%|█████████▏| 395/432 [00:44<00:03,  9.60it/s, loss:1.50431]Epoch 12/12:  91%|█████████▏| 395/432 [00:44<00:03,  9.60it/s, loss:1.50431]Epoch 12/12:  93%|█████████▎| 400/432 [00:45<00:04,  8.00it/s, loss:1.50431]Epoch 12/12:  93%|█████████▎| 400/432 [00:45<00:04,  8.00it/s, loss:1.53634]Epoch 12/12:  94%|█████████▍| 405/432 [00:45<00:03,  8.44it/s, loss:1.53634]Epoch 12/12:  94%|█████████▍| 405/432 [00:45<00:03,  8.44it/s, loss:1.50857]Epoch 12/12:  95%|█████████▍| 410/432 [00:46<00:02,  8.80it/s, loss:1.50857]Epoch 12/12:  95%|█████████▍| 410/432 [00:46<00:02,  8.80it/s, loss:1.36256]Epoch 12/12:  96%|█████████▌| 415/432 [00:46<00:01,  9.04it/s, loss:1.36256]Epoch 12/12:  96%|█████████▌| 415/432 [00:46<00:01,  9.04it/s, loss:1.42657]Epoch 12/12:  97%|█████████▋| 420/432 [00:47<00:01,  9.26it/s, loss:1.42657]Epoch 12/12:  97%|█████████▋| 420/432 [00:47<00:01,  9.26it/s, loss:1.26661]Epoch 12/12:  98%|█████████▊| 425/432 [00:47<00:00,  9.42it/s, loss:1.26661]Epoch 12/12:  98%|█████████▊| 425/432 [00:47<00:00,  9.42it/s, loss:1.56659]Epoch 12/12: 100%|█████████▉| 430/432 [00:48<00:00,  9.52it/s, loss:1.56659]Epoch 12/12: 100%|█████████▉| 430/432 [00:48<00:00,  9.52it/s, loss:1.32189]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.17it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.42it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.10it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.33it/s][A
                                                   [A                                                                            Epoch 12/12: 100%|█████████▉| 430/432 [00:49<00:00,  9.52it/s, loss:1.32189]                                                                            Epoch 12/12: 100%|█████████▉| 430/432 [00:49<00:00,  9.52it/s, loss:1.32189]                                                                            Epoch 12/12: 100%|█████████▉| 430/432 [00:49<00:00,  9.52it/s, loss:1.32189]                                                                            /home/rockyo/anaconda3/envs/aicup/lib/python3.7/site-packages/fastNLP/embeddings/bert_embedding.py:430: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  self.word_to_wordpieces = np.array(word_to_wordpieces)
  0%|          | 0/420 [00:00<?, ?it/s, loss:{0:<6.5f}]Epoch 1/12:   0%|          | 0/420 [00:00<?, ?it/s, loss:{0:<6.5f}]Epoch 1/12:   1%|          | 5/420 [00:00<00:40, 10.21it/s, loss:{0:<6.5f}]Epoch 1/12:   1%|          | 5/420 [00:00<00:40, 10.21it/s, loss:2.02468]  Epoch 1/12:   2%|▏         | 10/420 [00:00<00:40, 10.18it/s, loss:2.02468]Epoch 1/12:   2%|▏         | 10/420 [00:00<00:40, 10.18it/s, loss:1.90957]Epoch 1/12:   4%|▎         | 15/420 [00:01<00:40, 10.08it/s, loss:1.90957]Epoch 1/12:   4%|▎         | 15/420 [00:01<00:40, 10.08it/s, loss:1.91899]Epoch 1/12:   5%|▍         | 20/420 [00:01<00:39, 10.09it/s, loss:1.91899]Epoch 1/12:   5%|▍         | 20/420 [00:01<00:39, 10.09it/s, loss:1.91288]Epoch 1/12:   6%|▌         | 25/420 [00:02<00:39,  9.88it/s, loss:1.91288]Epoch 1/12:   6%|▌         | 25/420 [00:02<00:39,  9.88it/s, loss:1.93022]Epoch 1/12:   7%|▋         | 30/420 [00:03<00:39,  9.85it/s, loss:1.93022]Epoch 1/12:   7%|▋         | 30/420 [00:03<00:39,  9.85it/s, loss:1.90041]Epoch 1/12:   8%|▊         | 35/420 [00:03<00:38, 10.03it/s, loss:1.90041]Epoch 1/12:   8%|▊         | 35/420 [00:03<00:38, 10.03it/s, loss:1.87846]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 18.35it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 18.83it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 18.91it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 18.88it/s][A
                                                   [A                                                                          Epoch 1/12:   8%|▊         | 35/420 [00:03<00:38, 10.03it/s, loss:1.87846]                                                                          Epoch 1/12:   8%|▊         | 35/420 [00:04<00:38, 10.03it/s, loss:1.87846]                                                                          Epoch 1/12:   8%|▊         | 35/420 [00:04<00:38, 10.03it/s, loss:1.87846]/home/rockyo/anaconda3/envs/aicup/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:154: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch 2/12:   8%|▊         | 35/420 [00:04<00:38, 10.03it/s, loss:1.87846]Epoch 2/12:  10%|▉         | 40/420 [00:04<00:53,  7.08it/s, loss:1.87846]Epoch 2/12:  10%|▉         | 40/420 [00:04<00:53,  7.08it/s, loss:1.86916]Epoch 2/12:  11%|█         | 45/420 [00:05<00:48,  7.74it/s, loss:1.86916]Epoch 2/12:  11%|█         | 45/420 [00:05<00:48,  7.74it/s, loss:1.90603]Epoch 2/12:  12%|█▏        | 50/420 [00:05<00:44,  8.35it/s, loss:1.90603]Epoch 2/12:  12%|█▏        | 50/420 [00:05<00:44,  8.35it/s, loss:1.87612]Epoch 2/12:  13%|█▎        | 55/420 [00:06<00:41,  8.73it/s, loss:1.87612]Epoch 2/12:  13%|█▎        | 55/420 [00:06<00:41,  8.73it/s, loss:1.85578]Epoch 2/12:  14%|█▍        | 60/420 [00:06<00:39,  9.14it/s, loss:1.85578]Epoch 2/12:  14%|█▍        | 60/420 [00:06<00:39,  9.14it/s, loss:1.90576]Epoch 2/12:  15%|█▌        | 65/420 [00:07<00:37,  9.39it/s, loss:1.90576]Epoch 2/12:  15%|█▌        | 65/420 [00:07<00:37,  9.39it/s, loss:1.91160]Epoch 2/12:  17%|█▋        | 70/420 [00:07<00:35,  9.73it/s, loss:1.91160]Epoch 2/12:  17%|█▋        | 70/420 [00:07<00:35,  9.73it/s, loss:1.86059]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 18.38it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 18.84it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 18.89it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 18.86it/s][A
                                                   [A                                                                          Epoch 2/12:  17%|█▋        | 70/420 [00:08<00:35,  9.73it/s, loss:1.86059]                                                                          Epoch 2/12:  17%|█▋        | 70/420 [00:08<00:35,  9.73it/s, loss:1.86059]                                                                          Epoch 2/12:  17%|█▋        | 70/420 [00:08<00:35,  9.73it/s, loss:1.86059]Epoch 3/12:  17%|█▋        | 70/420 [00:08<00:35,  9.73it/s, loss:1.86059]Epoch 3/12:  18%|█▊        | 75/420 [00:08<00:48,  7.06it/s, loss:1.86059]Epoch 3/12:  18%|█▊        | 75/420 [00:08<00:48,  7.06it/s, loss:1.78094]Epoch 3/12:  19%|█▉        | 80/420 [00:09<00:43,  7.75it/s, loss:1.78094]Epoch 3/12:  19%|█▉        | 80/420 [00:09<00:43,  7.75it/s, loss:1.89008]Epoch 3/12:  20%|██        | 85/420 [00:09<00:40,  8.33it/s, loss:1.89008]Epoch 3/12:  20%|██        | 85/420 [00:09<00:40,  8.33it/s, loss:1.95162]Epoch 3/12:  21%|██▏       | 90/420 [00:10<00:37,  8.83it/s, loss:1.95162]Epoch 3/12:  21%|██▏       | 90/420 [00:10<00:37,  8.83it/s, loss:1.85593]Epoch 3/12:  23%|██▎       | 95/420 [00:10<00:35,  9.14it/s, loss:1.85593]Epoch 3/12:  23%|██▎       | 95/420 [00:10<00:35,  9.14it/s, loss:1.85728]Epoch 3/12:  24%|██▍       | 100/420 [00:11<00:34,  9.32it/s, loss:1.85728]Epoch 3/12:  24%|██▍       | 100/420 [00:11<00:34,  9.32it/s, loss:1.85079]Epoch 3/12:  25%|██▌       | 105/420 [00:11<00:32,  9.63it/s, loss:1.85079]Epoch 3/12:  25%|██▌       | 105/420 [00:11<00:32,  9.63it/s, loss:1.81417]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 18.36it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 18.81it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 18.91it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 18.90it/s][A
                                                   [A                                                                           Epoch 3/12:  25%|██▌       | 105/420 [00:12<00:32,  9.63it/s, loss:1.81417]                                                                           Epoch 3/12:  25%|██▌       | 105/420 [00:12<00:32,  9.63it/s, loss:1.81417]                                                                           Epoch 3/12:  25%|██▌       | 105/420 [00:12<00:32,  9.63it/s, loss:1.81417]Epoch 4/12:  25%|██▌       | 105/420 [00:12<00:32,  9.63it/s, loss:1.81417]Epoch 4/12:  26%|██▌       | 110/420 [00:12<00:43,  7.08it/s, loss:1.81417]Epoch 4/12:  26%|██▌       | 110/420 [00:12<00:43,  7.08it/s, loss:1.86355]Epoch 4/12:  27%|██▋       | 115/420 [00:13<00:39,  7.72it/s, loss:1.86355]Epoch 4/12:  27%|██▋       | 115/420 [00:13<00:39,  7.72it/s, loss:1.84504]Epoch 4/12:  29%|██▊       | 120/420 [00:13<00:36,  8.28it/s, loss:1.84504]Epoch 4/12:  29%|██▊       | 120/420 [00:13<00:36,  8.28it/s, loss:1.86467]Epoch 4/12:  30%|██▉       | 125/420 [00:14<00:34,  8.65it/s, loss:1.86467]Epoch 4/12:  30%|██▉       | 125/420 [00:14<00:34,  8.65it/s, loss:1.69963]Epoch 4/12:  31%|███       | 130/420 [00:14<00:32,  8.98it/s, loss:1.69963]Epoch 4/12:  31%|███       | 130/420 [00:14<00:32,  8.98it/s, loss:1.86961]Epoch 4/12:  32%|███▏      | 135/420 [00:15<00:30,  9.20it/s, loss:1.86961]Epoch 4/12:  32%|███▏      | 135/420 [00:15<00:30,  9.20it/s, loss:1.70496]Epoch 4/12:  33%|███▎      | 140/420 [00:15<00:29,  9.61it/s, loss:1.70496]Epoch 4/12:  33%|███▎      | 140/420 [00:15<00:29,  9.61it/s, loss:1.83944]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 18.31it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 18.82it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 18.92it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 18.92it/s][A
                                                   [A                                                                           Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.61it/s, loss:1.83944]                                                                           Save cache to ./cache/qa_train_fold0_reverseBC_False.
Save cache to ./cache/qa_val_fold0_reverseBC_False.
Save cache to ./cache/qa_train_fold1_reverseBC_False.
Save cache to ./cache/qa_val_fold1_reverseBC_False.
Save cache to ./cache/qa_train_fold2_reverseBC_False.
Save cache to ./cache/qa_val_fold2_reverseBC_False.
Save cache to ./cache/qa_train_fold3_reverseBC_False.
Save cache to ./cache/qa_val_fold3_reverseBC_False.
Save cache to ./cache/qa_train_fold4_reverseBC_False.
Save cache to ./cache/qa_val_fold4_reverseBC_False.
Save cache to ./cache/qa_dev_reverseBC_False.
+----------------+----------------+-----------------+--------+---------------+----------------+-----------+
| raw_text       | cho            | q               | target | target_onehot | roleid         | q_seq_len |
+----------------+----------------+-----------------+--------+---------------+----------------+-----------+
| [['阿不太',... | [['關於', '... | ['關於', '民... | 0      | [1. 0. 0.]    | [[1, 1, 1, ... | 7         |
| [['嗯', '哼... | [['關於', '... | ['關於', '民... | 1      | [0. 1. 0.]    | [[4, 4, 4, ... | 8         |
| [['過去', '... | [['下列', '... | ['下列', '敘... | 2      | [0. 0. 1.]    | [[4, 4, 4, ... | 5         |
| [['所以', '... | [['民眾', '... | ['民眾', '的... | 0      | [1. 0. 0.]    | [[4, 4, 4, ... | 7         |
| [['那', '如... | [['請問', '... | ['請問', '下... | 2      | [0. 0. 1.]    | [[4, 4, 4, ... | 13        |
| [['好', '哦... | [['請問', '... | ['請問', '民... | 0      | [1. 0. 0.]    | [[4, 4, 4, ... | 8         |
| [['不會', '... | [['民眾', '... | ['民眾', '吃... | 2      | [0. 0. 1.]    | [[1, 1, 4, ... | 10        |
| [['恩', '…...  | [['關於', '... | ['關於', '民... | 0      | [1. 0. 0.]    | [[1, 1, 1, ... | 8         |
| [['欸', '你... | [['請問', '... | ['請問', '個... | 0      | [1. 0. 0.]    | [[4, 4, 4, ... | 12        |
| [['可是', '... | [['下列', '... | ['下列', '關... | 1      | [0. 1. 0.]    | [[1, 1, 1, ... | 10        |
| [['所以', '... | [['下列', '... | ['下列', '敘... | 2      | [0. 0. 1.]    | [[4, 4, 4, ... | 5         |
| [['問題', '... | [['請問', '... | ['請問', '民... | 0      | [1. 0. 0.]    | [[1, 1, 1, ... | 8         |
| ...            | ...            | ...             | ...    | ...           | ...            | ...       |
+----------------+----------------+-----------------+--------+---------------+----------------+-----------+
[34mAuto commit by fitlog[0m
--------Fold0----------
Found 7550 out of 10306 words in the pre-training embedding.
loading vocabulary file /home/rockyo/.fastNLP/embedding/bert-chinese-wwm-ext/vocab.txt
The transformer encoder will early exit after layer-1 (start from 0)!
Load pre-trained BERT parameters from file /home/rockyo/.fastNLP/embedding/bert-chinese-wwm-ext/pytorch_model.bin.
input fields after batch(if batch size is 2):
	raw_text: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 3, 169]) 
	cho: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 3, 21]) 
	q: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 12]) 
	target_onehot: (1)type:torch.Tensor (2)dtype:torch.float32, (3)shape:torch.Size([2, 3]) 
	roleid: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 3, 169]) 
	q_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 
target fields after batch(if batch size is 2):
	target: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 

training epochs started 2021-06-17-00-59-12-436026
Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 1/12. Step:36/432: 
AccuracyMetric: acc=0.461538
Acc_loss_Metric: val_loss=1.892703
ClassifyFPreRecMetric: f=0.349984, pre=0.307971, rec=0.40592

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 2/12. Step:72/432: 
AccuracyMetric: acc=0.330769
Acc_loss_Metric: val_loss=2.010124
ClassifyFPreRecMetric: f=0.167641, pre=0.111979, rec=0.333333

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 3/12. Step:108/432: 
AccuracyMetric: acc=0.515385
Acc_loss_Metric: val_loss=1.795284
ClassifyFPreRecMetric: f=0.389326, pre=0.352898, rec=0.444961

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 4/12. Step:144/432: 
AccuracyMetric: acc=0.546154
Acc_loss_Metric: val_loss=1.744879
ClassifyFPreRecMetric: f=0.430986, pre=0.701777, rec=0.480325

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 5/12. Step:180/432: 
AccuracyMetric: acc=0.546154
Acc_loss_Metric: val_loss=1.824719
ClassifyFPreRecMetric: f=0.414951, pre=0.364902, rec=0.481043

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 6/12. Step:216/432: 
AccuracyMetric: acc=0.538462
Acc_loss_Metric: val_loss=1.712166
ClassifyFPreRecMetric: f=0.391111, pre=0.371386, rec=0.456378

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 7/12. Step:252/432: 
AccuracyMetric: acc=0.553846
Acc_loss_Metric: val_loss=1.726269
ClassifyFPreRecMetric: f=0.414456, pre=0.373875, rec=0.478647

Evaluate data in 0.44 seconds!
Evaluation on dev at Epoch 8/12. Step:288/432: 
AccuracyMetric: acc=0.492308
Acc_loss_Metric: val_loss=1.841957
ClassifyFPreRecMetric: f=0.375841, pre=0.332289, rec=0.44031

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 9/12. Step:324/432: 
AccuracyMetric: acc=0.484615
Acc_loss_Metric: val_loss=1.843049
ClassifyFPreRecMetric: f=0.365141, pre=0.323487, rec=0.420719

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 10/12. Step:360/432: 
AccuracyMetric: acc=0.546154
Acc_loss_Metric: val_loss=1.746363
ClassifyFPreRecMetric: f=0.407407, pre=0.362044, rec=0.472586

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 11/12. Step:396/432: 
AccuracyMetric: acc=0.492308
Acc_loss_Metric: val_loss=1.934101
ClassifyFPreRecMetric: f=0.377506, pre=0.336199, rec=0.44031

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 12/12. Step:432/432: 
AccuracyMetric: acc=0.523077
Acc_loss_Metric: val_loss=2.114186
ClassifyFPreRecMetric: f=0.394296, pre=0.347733, rec=0.456096

Reloaded the best model.

In Epoch:7/Step:252, got best dev performance:
AccuracyMetric: acc=0.553846
Acc_loss_Metric: val_loss=1.726269
ClassifyFPreRecMetric: f=0.414456, pre=0.373875, rec=0.478647
Visualization...
[2, 2, 0, 2, 2, 0, 0, 2, 0, 2, 2, 0, 2, 2, 0, 2, 2, 2, 2, 2]
acc 0.5538
Predicting dev...
writing pred0.npy...
[34mAuto commit by fitlog[0m
--------Fold1----------
Found 7550 out of 10306 words in the pre-training embedding.
loading vocabulary file /home/rockyo/.fastNLP/embedding/bert-chinese-wwm-ext/vocab.txt
The transformer encoder will early exit after layer-1 (start from 0)!
Load pre-trained BERT parameters from file /home/rockyo/.fastNLP/embedding/bert-chinese-wwm-ext/pytorch_model.bin.
input fields after batch(if batch size is 2):
	raw_text: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 3, 177]) 
	cho: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 3, 15]) 
	q: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 12]) 
	target_onehot: (1)type:torch.Tensor (2)dtype:torch.float32, (3)shape:torch.Size([2, 3]) 
	roleid: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 3, 177]) 
	q_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 
target fields after batch(if batch size is 2):
	target: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 

training epochs started 2021-06-17-01-00-32-494298
Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 1/12. Step:35/420: 
AccuracyMetric: acc=0.369565
Acc_loss_Metric: val_loss=1.917996
ClassifyFPreRecMetric: f=0.279715, pre=0.253429, rec=0.339109

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 2/12. Step:70/420: 
AccuracyMetric: acc=0.434783
Acc_loss_Metric: val_loss=1.894701
ClassifyFPreRecMetric: f=0.330189, pre=0.289263, rec=0.384683

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 3/12. Step:105/420: 
AccuracyMetric: acc=0.514493
Acc_loss_Metric: val_loss=1.81236
ClassifyFPreRecMetric: f=0.375789, pre=0.351852, rec=0.436284

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 4/12. Step:140/420: Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.61it/s, loss:1.83944]                                                                           Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.61it/s, loss:1.83944]Epoch 5/12:  33%|███▎      | 140/420 [00:16<00:29,  9.61it/s, loss:1.83944]Epoch 5/12:  35%|███▍      | 145/420 [00:16<00:35,  7.69it/s, loss:1.83944]Epoch 5/12:  35%|███▍      | 145/420 [00:16<00:35,  7.69it/s, loss:1.84880]Epoch 5/12:  36%|███▌      | 150/420 [00:17<00:32,  8.19it/s, loss:1.84880]Epoch 5/12:  36%|███▌      | 150/420 [00:17<00:32,  8.19it/s, loss:1.82501]Epoch 5/12:  37%|███▋      | 155/420 [00:17<00:30,  8.60it/s, loss:1.82501]Epoch 5/12:  37%|███▋      | 155/420 [00:17<00:30,  8.60it/s, loss:1.67924]Epoch 5/12:  38%|███▊      | 160/420 [00:18<00:28,  8.98it/s, loss:1.67924]Epoch 5/12:  38%|███▊      | 160/420 [00:18<00:28,  8.98it/s, loss:1.66140]Epoch 5/12:  39%|███▉      | 165/420 [00:18<00:27,  9.24it/s, loss:1.66140]Epoch 5/12:  39%|███▉      | 165/420 [00:18<00:27,  9.24it/s, loss:1.68959]Epoch 5/12:  40%|████      | 170/420 [00:19<00:26,  9.42it/s, loss:1.68959]Epoch 5/12:  40%|████      | 170/420 [00:19<00:26,  9.42it/s, loss:1.81213]Epoch 5/12:  42%|████▏     | 175/420 [00:19<00:25,  9.70it/s, loss:1.81213]Epoch 5/12:  42%|████▏     | 175/420 [00:19<00:25,  9.70it/s, loss:1.73110]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 18.25it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 18.72it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 18.80it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 18.82it/s][A
                                                   [A                                                                           Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:25,  9.70it/s, loss:1.73110]                                                                           Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:25,  9.70it/s, loss:1.73110]                                                                           Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:25,  9.70it/s, loss:1.73110]Epoch 6/12:  42%|████▏     | 175/420 [00:20<00:25,  9.70it/s, loss:1.73110]Epoch 6/12:  43%|████▎     | 180/420 [00:20<00:31,  7.66it/s, loss:1.73110]Epoch 6/12:  43%|████▎     | 180/420 [00:20<00:31,  7.66it/s, loss:1.66477]Epoch 6/12:  44%|████▍     | 185/420 [00:21<00:28,  8.20it/s, loss:1.66477]Epoch 6/12:  44%|████▍     | 185/420 [00:21<00:28,  8.20it/s, loss:1.62636]Epoch 6/12:  45%|████▌     | 190/420 [00:21<00:26,  8.64it/s, loss:1.62636]Epoch 6/12:  45%|████▌     | 190/420 [00:21<00:26,  8.64it/s, loss:1.71392]Epoch 6/12:  46%|████▋     | 195/420 [00:22<00:25,  8.99it/s, loss:1.71392]Epoch 6/12:  46%|████▋     | 195/420 [00:22<00:25,  8.99it/s, loss:1.73818]Epoch 6/12:  48%|████▊     | 200/420 [00:22<00:23,  9.25it/s, loss:1.73818]Epoch 6/12:  48%|████▊     | 200/420 [00:22<00:23,  9.25it/s, loss:1.67302]Epoch 6/12:  49%|████▉     | 205/420 [00:23<00:22,  9.53it/s, loss:1.67302]Epoch 6/12:  49%|████▉     | 205/420 [00:23<00:22,  9.53it/s, loss:1.56653]Epoch 6/12:  50%|█████     | 210/420 [00:23<00:21,  9.80it/s, loss:1.56653]Epoch 6/12:  50%|█████     | 210/420 [00:23<00:21,  9.80it/s, loss:1.56403]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 18.36it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 18.77it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 18.90it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 18.86it/s][A
                                                   [A                                                                           Epoch 6/12:  50%|█████     | 210/420 [00:24<00:21,  9.80it/s, loss:1.56403]                                                                           Epoch 6/12:  50%|█████     | 210/420 [00:24<00:21,  9.80it/s, loss:1.56403]                                                                           Epoch 6/12:  50%|█████     | 210/420 [00:24<00:21,  9.80it/s, loss:1.56403]Epoch 7/12:  50%|█████     | 210/420 [00:24<00:21,  9.80it/s, loss:1.56403]Epoch 7/12:  51%|█████     | 215/420 [00:24<00:26,  7.73it/s, loss:1.56403]Epoch 7/12:  51%|█████     | 215/420 [00:24<00:26,  7.73it/s, loss:1.69010]Epoch 7/12:  52%|█████▏    | 220/420 [00:25<00:24,  8.30it/s, loss:1.69010]Epoch 7/12:  52%|█████▏    | 220/420 [00:25<00:24,  8.30it/s, loss:1.73388]Epoch 7/12:  54%|█████▎    | 225/420 [00:25<00:22,  8.70it/s, loss:1.73388]Epoch 7/12:  54%|█████▎    | 225/420 [00:25<00:22,  8.70it/s, loss:1.65873]Epoch 7/12:  55%|█████▍    | 230/420 [00:26<00:20,  9.11it/s, loss:1.65873]Epoch 7/12:  55%|█████▍    | 230/420 [00:26<00:20,  9.11it/s, loss:1.46587]Epoch 7/12:  56%|█████▌    | 235/420 [00:26<00:20,  9.24it/s, loss:1.46587]Epoch 7/12:  56%|█████▌    | 235/420 [00:26<00:20,  9.24it/s, loss:1.71412]Epoch 7/12:  57%|█████▋    | 240/420 [00:27<00:19,  9.46it/s, loss:1.71412]Epoch 7/12:  57%|█████▋    | 240/420 [00:27<00:19,  9.46it/s, loss:1.69455]Epoch 7/12:  58%|█████▊    | 245/420 [00:27<00:18,  9.67it/s, loss:1.69455]Epoch 7/12:  58%|█████▊    | 245/420 [00:27<00:18,  9.67it/s, loss:1.80371]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 18.28it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 18.71it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 18.83it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 18.81it/s][A
                                                   [A                                                                           Epoch 7/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.67it/s, loss:1.80371]                                                                           Epoch 7/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.67it/s, loss:1.80371]                                                                           Epoch 7/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.67it/s, loss:1.80371]Epoch 8/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.67it/s, loss:1.80371]Epoch 8/12:  60%|█████▉    | 250/420 [00:28<00:22,  7.66it/s, loss:1.80371]Epoch 8/12:  60%|█████▉    | 250/420 [00:28<00:22,  7.66it/s, loss:1.63813]Epoch 8/12:  61%|██████    | 255/420 [00:29<00:20,  8.22it/s, loss:1.63813]Epoch 8/12:  61%|██████    | 255/420 [00:29<00:20,  8.22it/s, loss:1.64462]Epoch 8/12:  62%|██████▏   | 260/420 [00:29<00:18,  8.66it/s, loss:1.64462]Epoch 8/12:  62%|██████▏   | 260/420 [00:29<00:18,  8.66it/s, loss:1.63315]Epoch 8/12:  63%|██████▎   | 265/420 [00:30<00:17,  9.00it/s, loss:1.63315]Epoch 8/12:  63%|██████▎   | 265/420 [00:30<00:17,  9.00it/s, loss:1.51253]Epoch 8/12:  64%|██████▍   | 270/420 [00:30<00:16,  9.19it/s, loss:1.51253]Epoch 8/12:  64%|██████▍   | 270/420 [00:30<00:16,  9.19it/s, loss:1.62202]Epoch 8/12:  65%|██████▌   | 275/420 [00:31<00:15,  9.41it/s, loss:1.62202]Epoch 8/12:  65%|██████▌   | 275/420 [00:31<00:15,  9.41it/s, loss:1.65932]Epoch 8/12:  67%|██████▋   | 280/420 [00:31<00:14,  9.69it/s, loss:1.65932]Epoch 8/12:  67%|██████▋   | 280/420 [00:31<00:14,  9.69it/s, loss:1.87040]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 18.09it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 18.57it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 18.71it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 18.70it/s][A
                                                   [A                                                                           Epoch 8/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.69it/s, loss:1.87040]                                                                           Epoch 8/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.69it/s, loss:1.87040]                                                                           Epoch 8/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.69it/s, loss:1.87040]Epoch 9/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.69it/s, loss:1.87040]Epoch 9/12:  68%|██████▊   | 285/420 [00:32<00:17,  7.70it/s, loss:1.87040]Epoch 9/12:  68%|██████▊   | 285/420 [00:32<00:17,  7.70it/s, loss:1.56209]Epoch 9/12:  69%|██████▉   | 290/420 [00:33<00:15,  8.26it/s, loss:1.56209]Epoch 9/12:  69%|██████▉   | 290/420 [00:33<00:15,  8.26it/s, loss:1.56457]Epoch 9/12:  70%|███████   | 295/420 [00:33<00:14,  8.72it/s, loss:1.56457]Epoch 9/12:  70%|███████   | 295/420 [00:33<00:14,  8.72it/s, loss:1.71073]Epoch 9/12:  71%|███████▏  | 300/420 [00:34<00:13,  9.03it/s, loss:1.71073]Epoch 9/12:  71%|███████▏  | 300/420 [00:34<00:13,  9.03it/s, loss:1.69280]Epoch 9/12:  73%|███████▎  | 305/420 [00:34<00:12,  9.21it/s, loss:1.69280]Epoch 9/12:  73%|███████▎  | 305/420 [00:34<00:12,  9.21it/s, loss:1.59577]Epoch 9/12:  74%|███████▍  | 310/420 [00:35<00:11,  9.35it/s, loss:1.59577]Epoch 9/12:  74%|███████▍  | 310/420 [00:35<00:11,  9.35it/s, loss:1.63393]Epoch 9/12:  75%|███████▌  | 315/420 [00:35<00:10,  9.61it/s, loss:1.63393]Epoch 9/12:  75%|███████▌  | 315/420 [00:35<00:10,  9.61it/s, loss:1.62407]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 18.18it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 18.60it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 18.67it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 18.62it/s][A
                                                   [A                                                                           Epoch 9/12:  75%|███████▌  | 315/420 [00:36<00:10,  9.61it/s, loss:1.62407]                                                                           Epoch 9/12:  75%|███████▌  | 315/420 [00:36<00:10,  9.61it/s, loss:1.62407]                                                                           Epoch 9/12:  75%|███████▌  | 315/420 [00:36<00:10,  9.61it/s, loss:1.62407]Epoch 10/12:  75%|███████▌  | 315/420 [00:36<00:10,  9.61it/s, loss:1.62407]Epoch 10/12:  76%|███████▌  | 320/420 [00:36<00:13,  7.63it/s, loss:1.62407]Epoch 10/12:  76%|███████▌  | 320/420 [00:36<00:13,  7.63it/s, loss:1.60614]Epoch 10/12:  77%|███████▋  | 325/420 [00:37<00:11,  8.17it/s, loss:1.60614]Epoch 10/12:  77%|███████▋  | 325/420 [00:37<00:11,  8.17it/s, loss:1.69289]Epoch 10/12:  79%|███████▊  | 330/420 [00:37<00:10,  8.58it/s, loss:1.69289]Epoch 10/12:  79%|███████▊  | 330/420 [00:37<00:10,  8.58it/s, loss:1.58373]Epoch 10/12:  80%|███████▉  | 335/420 [00:38<00:09,  8.88it/s, loss:1.58373]Epoch 10/12:  80%|███████▉  | 335/420 [00:38<00:09,  8.88it/s, loss:1.57502]Epoch 10/12:  81%|████████  | 340/420 [00:38<00:08,  9.19it/s, loss:1.57502]Epoch 10/12:  81%|████████  | 340/420 [00:38<00:08,  9.19it/s, loss:1.56016]Epoch 10/12:  82%|████████▏ | 345/420 [00:39<00:07,  9.44it/s, loss:1.56016]Epoch 10/12:  82%|████████▏ | 345/420 [00:39<00:07,  9.44it/s, loss:1.60278]Epoch 10/12:  83%|████████▎ | 350/420 [00:39<00:07,  9.68it/s, loss:1.60278]Epoch 10/12:  83%|████████▎ | 350/420 [00:39<00:07,  9.68it/s, loss:1.58641]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 18.16it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 18.57it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 18.67it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 18.65it/s][A
                                                   [A                                                                            Epoch 10/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.68it/s, loss:1.58641]                                                                            Epoch 10/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.68it/s, loss:1.58641]                                                                            Epoch 10/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.68it/s, loss:1.58641]Epoch 11/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.68it/s, loss:1.58641]Epoch 11/12:  85%|████████▍ | 355/420 [00:40<00:08,  7.68it/s, loss:1.58641]Epoch 11/12:  85%|████████▍ | 355/420 [00:40<00:08,  7.68it/s, loss:1.49352]Epoch 11/12:  86%|████████▌ | 360/420 [00:41<00:07,  8.20it/s, loss:1.49352]Epoch 11/12:  86%|████████▌ | 360/420 [00:41<00:07,  8.20it/s, loss:1.45854]Epoch 11/12:  87%|████████▋ | 365/420 [00:41<00:06,  8.65it/s, loss:1.45854]Epoch 11/12:  87%|████████▋ | 365/420 [00:41<00:06,  8.65it/s, loss:1.64064]Epoch 11/12:  88%|████████▊ | 370/420 [00:42<00:05,  8.96it/s, loss:1.64064]Epoch 11/12:  88%|████████▊ | 370/420 [00:42<00:05,  8.96it/s, loss:1.66404]Epoch 11/12:  89%|████████▉ | 375/420 [00:42<00:04,  9.21it/s, loss:1.66404]Epoch 11/12:  89%|████████▉ | 375/420 [00:42<00:04,  9.21it/s, loss:1.61889]Epoch 11/12:  90%|█████████ | 380/420 [00:43<00:04,  9.39it/s, loss:1.61889]Epoch 11/12:  90%|█████████ | 380/420 [00:43<00:04,  9.39it/s, loss:1.66594]Epoch 11/12:  92%|█████████▏| 385/420 [00:43<00:03,  9.60it/s, loss:1.66594]Epoch 11/12:  92%|█████████▏| 385/420 [00:43<00:03,  9.60it/s, loss:1.49730]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 18.10it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 18.60it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 18.68it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 18.62it/s][A
                                                   [A                                                                            Epoch 11/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.60it/s, loss:1.49730]                                                                            Epoch 11/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.60it/s, loss:1.49730]                                                                            Epoch 11/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.60it/s, loss:1.49730]Epoch 12/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.60it/s, loss:1.49730]Epoch 12/12:  93%|█████████▎| 390/420 [00:44<00:03,  7.63it/s, loss:1.49730]Epoch 12/12:  93%|█████████▎| 390/420 [00:44<00:03,  7.63it/s, loss:1.68727]Epoch 12/12:  94%|█████████▍| 395/420 [00:45<00:03,  8.18it/s, loss:1.68727]Epoch 12/12:  94%|█████████▍| 395/420 [00:45<00:03,  8.18it/s, loss:1.60828]Epoch 12/12:  95%|█████████▌| 400/420 [00:45<00:02,  8.62it/s, loss:1.60828]Epoch 12/12:  95%|█████████▌| 400/420 [00:45<00:02,  8.62it/s, loss:1.56764]Epoch 12/12:  96%|█████████▋| 405/420 [00:46<00:01,  8.89it/s, loss:1.56764]Epoch 12/12:  96%|█████████▋| 405/420 [00:46<00:01,  8.89it/s, loss:1.62493]Epoch 12/12:  98%|█████████▊| 410/420 [00:46<00:01,  9.16it/s, loss:1.62493]Epoch 12/12:  98%|█████████▊| 410/420 [00:46<00:01,  9.16it/s, loss:1.47323]Epoch 12/12:  99%|█████████▉| 415/420 [00:47<00:00,  9.36it/s, loss:1.47323]Epoch 12/12:  99%|█████████▉| 415/420 [00:47<00:00,  9.36it/s, loss:1.61353]Epoch 12/12: 100%|██████████| 420/420 [00:47<00:00,  9.66it/s, loss:1.61353]Epoch 12/12: 100%|██████████| 420/420 [00:47<00:00,  9.66it/s, loss:1.65436]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 18.31it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 18.73it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 18.79it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 18.75it/s][A
                                                   [A                                                                            Epoch 12/12: 100%|██████████| 420/420 [00:48<00:00,  9.66it/s, loss:1.65436]                                                                            Epoch 12/12: 100%|██████████| 420/420 [00:48<00:00,  9.66it/s, loss:1.65436]                                                                            Epoch 12/12: 100%|██████████| 420/420 [00:48<00:00,  9.66it/s, loss:1.65436]                                                                            /home/rockyo/anaconda3/envs/aicup/lib/python3.7/site-packages/fastNLP/embeddings/bert_embedding.py:430: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  self.word_to_wordpieces = np.array(word_to_wordpieces)
  0%|          | 0/420 [00:00<?, ?it/s, loss:{0:<6.5f}]Epoch 1/12:   0%|          | 0/420 [00:00<?, ?it/s, loss:{0:<6.5f}]Epoch 1/12:   1%|          | 5/420 [00:00<00:42,  9.83it/s, loss:{0:<6.5f}]Epoch 1/12:   1%|          | 5/420 [00:00<00:42,  9.83it/s, loss:2.02285]  Epoch 1/12:   2%|▏         | 10/420 [00:01<00:41,  9.88it/s, loss:2.02285]Epoch 1/12:   2%|▏         | 10/420 [00:01<00:41,  9.88it/s, loss:1.92309]Epoch 1/12:   4%|▎         | 15/420 [00:01<00:41,  9.66it/s, loss:1.92309]Epoch 1/12:   4%|▎         | 15/420 [00:01<00:41,  9.66it/s, loss:1.91117]Epoch 1/12:   5%|▍         | 20/420 [00:02<00:40,  9.76it/s, loss:1.91117]Epoch 1/12:   5%|▍         | 20/420 [00:02<00:40,  9.76it/s, loss:1.90879]Epoch 1/12:   6%|▌         | 25/420 [00:02<00:40,  9.77it/s, loss:1.90879]Epoch 1/12:   6%|▌         | 25/420 [00:02<00:40,  9.77it/s, loss:1.92119]Epoch 1/12:   7%|▋         | 30/420 [00:03<00:40,  9.74it/s, loss:1.92119]Epoch 1/12:   7%|▋         | 30/420 [00:03<00:40,  9.74it/s, loss:1.89823]Epoch 1/12:   8%|▊         | 35/420 [00:03<00:38, 10.05it/s, loss:1.89823]Epoch 1/12:   8%|▊         | 35/420 [00:03<00:38, 10.05it/s, loss:1.88637]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.87it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.94it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.55it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 20.24it/s][A
                                                   [A                                                                          Epoch 1/12:   8%|▊         | 35/420 [00:03<00:38, 10.05it/s, loss:1.88637]                                                                          Epoch 1/12:   8%|▊         | 35/420 [00:04<00:38, 10.05it/s, loss:1.88637]                                                                          Epoch 1/12:   8%|▊         | 35/420 [00:04<00:38, 10.05it/s, loss:1.88637]/home/rockyo/anaconda3/envs/aicup/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:154: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch 2/12:   8%|▊         | 35/420 [00:04<00:38, 10.05it/s, loss:1.88637]Epoch 2/12:  10%|▉         | 40/420 [00:04<00:53,  7.05it/s, loss:1.88637]Epoch 2/12:  10%|▉         | 40/420 [00:04<00:53,  7.05it/s, loss:1.88704]Epoch 2/12:  11%|█         | 45/420 [00:05<00:48,  7.75it/s, loss:1.88704]Epoch 2/12:  11%|█         | 45/420 [00:05<00:48,  7.75it/s, loss:1.87221]Epoch 2/12:  12%|█▏        | 50/420 [00:05<00:44,  8.35it/s, loss:1.87221]Epoch 2/12:  12%|█▏        | 50/420 [00:05<00:44,  8.35it/s, loss:1.85011]Epoch 2/12:  13%|█▎        | 55/420 [00:06<00:41,  8.81it/s, loss:1.85011]Epoch 2/12:  13%|█▎        | 55/420 [00:06<00:41,  8.81it/s, loss:1.85315]Epoch 2/12:  14%|█▍        | 60/420 [00:06<00:39,  9.05it/s, loss:1.85315]Epoch 2/12:  14%|█▍        | 60/420 [00:06<00:39,  9.05it/s, loss:1.88078]Epoch 2/12:  15%|█▌        | 65/420 [00:07<00:38,  9.20it/s, loss:1.88078]Epoch 2/12:  15%|█▌        | 65/420 [00:07<00:38,  9.20it/s, loss:1.83489]Epoch 2/12:  17%|█▋        | 70/420 [00:07<00:36,  9.58it/s, loss:1.83489]Epoch 2/12:  17%|█▋        | 70/420 [00:07<00:36,  9.58it/s, loss:1.91504]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.54it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.65it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.17it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.37it/s][A
                                                   [A                                                                          Epoch 2/12:  17%|█▋        | 70/420 [00:08<00:36,  9.58it/s, loss:1.91504]                                                                          Epoch 2/12:  17%|█▋        | 70/420 [00:08<00:36,  9.58it/s, loss:1.91504]                                                                          Epoch 2/12:  17%|█▋        | 70/420 [00:08<00:36,  9.58it/s, loss:1.91504]Epoch 3/12:  17%|█▋        | 70/420 [00:08<00:36,  9.58it/s, loss:1.91504]Epoch 3/12:  18%|█▊        | 75/420 [00:08<00:49,  6.98it/s, loss:1.91504]Epoch 3/12:  18%|█▊        | 75/420 [00:08<00:49,  6.98it/s, loss:1.83837]Epoch 3/12:  19%|█▉        | 80/420 [00:09<00:44,  7.60it/s, loss:1.83837]Epoch 3/12:  19%|█▉        | 80/420 [00:09<00:44,  7.60it/s, loss:1.77594]Epoch 3/12:  20%|██        | 85/420 [00:09<00:41,  8.14it/s, loss:1.77594]Epoch 3/12:  20%|██        | 85/420 [00:09<00:41,  8.14it/s, loss:1.85823]Epoch 3/12:  21%|██▏       | 90/420 [00:10<00:38,  8.61it/s, loss:1.85823]Epoch 3/12:  21%|██▏       | 90/420 [00:10<00:38,  8.61it/s, loss:1.77088]Epoch 3/12:  23%|██▎       | 95/420 [00:10<00:36,  8.98it/s, loss:1.77088]Epoch 3/12:  23%|██▎       | 95/420 [00:10<00:36,  8.98it/s, loss:1.76581]Epoch 3/12:  24%|██▍       | 100/420 [00:11<00:35,  9.14it/s, loss:1.76581]Epoch 3/12:  24%|██▍       | 100/420 [00:11<00:35,  9.14it/s, loss:1.89067]Epoch 3/12:  25%|██▌       | 105/420 [00:11<00:33,  9.51it/s, loss:1.89067]Epoch 3/12:  25%|██▌       | 105/420 [00:11<00:33,  9.51it/s, loss:1.75357]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.60it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.62it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.21it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.48it/s][A
                                                   [A                                                                           Epoch 3/12:  25%|██▌       | 105/420 [00:12<00:33,  9.51it/s, loss:1.75357]                                                                           Epoch 3/12:  25%|██▌       | 105/420 [00:12<00:33,  9.51it/s, loss:1.75357]                                                                           Epoch 3/12:  25%|██▌       | 105/420 [00:12<00:33,  9.51it/s, loss:1.75357]Epoch 4/12:  25%|██▌       | 105/420 [00:12<00:33,  9.51it/s, loss:1.75357]Epoch 4/12:  26%|██▌       | 110/420 [00:13<00:44,  7.03it/s, loss:1.75357]Epoch 4/12:  26%|██▌       | 110/420 [00:13<00:44,  7.03it/s, loss:1.78634]Epoch 4/12:  27%|██▋       | 115/420 [00:13<00:39,  7.68it/s, loss:1.78634]Epoch 4/12:  27%|██▋       | 115/420 [00:13<00:39,  7.68it/s, loss:1.92507]Epoch 4/12:  29%|██▊       | 120/420 [00:14<00:36,  8.17it/s, loss:1.92507]Epoch 4/12:  29%|██▊       | 120/420 [00:14<00:36,  8.17it/s, loss:1.92967]Epoch 4/12:  30%|██▉       | 125/420 [00:14<00:34,  8.49it/s, loss:1.92967]Epoch 4/12:  30%|██▉       | 125/420 [00:14<00:34,  8.49it/s, loss:1.84491]Epoch 4/12:  31%|███       | 130/420 [00:15<00:32,  8.87it/s, loss:1.84491]Epoch 4/12:  31%|███       | 130/420 [00:15<00:32,  8.87it/s, loss:1.74380]Epoch 4/12:  32%|███▏      | 135/420 [00:15<00:31,  9.13it/s, loss:1.74380]Epoch 4/12:  32%|███▏      | 135/420 [00:15<00:31,  9.13it/s, loss:1.68698]Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.51it/s, loss:1.68698]Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.51it/s, loss:1.68510]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.51it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.64it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.25it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.41it/s][A
                                                   [A                                                                           Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.51it/s, loss:1.68510]                                                                           Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.51it/s, loss:1.68510]                                                                           Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.51it/s, loss:1.68510]Epoch 5/12:  33%|███▎      | 140/420 [00:16<00:29,  9.51it/s, loss:1.68510]Epoch 5/12:  35%|███▍      | 145/420 [00:17<00:39,  6.96it/s, loss:1.68510]Epoch 5/12:  35%|███▍      | 145/420 [00:17<00:39,  6.96it/s, loss:1.72505]Epoch 5/12:  36%|███▌      | 150/420 [00:17<00:35,  7.54it/s, loss:1.72505]Epoch 5/12:  36%|███▌      | 150/420 [00:17<00:35,  7.54it/s, loss:1.75568]Epoch 5/12:  37%|███▋      | 155/420 [00:18<00:32,  8.12it/s, loss:1.75568]Epoch 5/12:  37%|███▋      | 155/420 [00:18<00:32,  8.12it/s, loss:1.59628]Epoch 5/12:  38%|███▊      | 160/420 [00:18<00:30,  8.56it/s, loss:1.59628]Epoch 5/12:  38%|███▊      | 160/420 [00:18<00:30,  8.56it/s, loss:1.77360]Epoch 5/12:  39%|███▉      | 165/420 [00:19<00:28,  8.95it/s, loss:1.77360]Epoch 5/12:  39%|███▉      | 165/420 [00:19<00:28,  8.95it/s, loss:1.76330]Epoch 5/12:  40%|████      | 170/420 [00:19<00:27,  9.11it/s, loss:1.76330]Epoch 5/12:  40%|████      | 170/420 [00:19<00:27,  9.11it/s, loss:1.77459]Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:25,  9.53it/s, loss:1.77459]Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:25,  9.53it/s, loss:1.80357]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.49it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.61it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.17it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.33it/s][A
                                                   [A                                                                           Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:25,  9.53it/s, loss:1.80357]                                                                           Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:25,  9.53it/s, loss:1.80357]                                                                           Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:25,  9.53it/s, loss:1.80357]Epoch 6/12:  42%|████▏     | 175/420 [00:20<00:25,  9.53it/s, loss:1.80357]Epoch 6/12:  43%|████▎     | 180/420 [00:21<00:34,  7.00it/s, loss:1.80357]Epoch 6/12:  43%|████▎     | 180/420 [00:21<00:34,  7.00it/s, loss:1.66186]Epoch 6/12:  44%|████▍     | 185/420 [00:22<00:30,  7.65it/s, loss:1.66186]Epoch 6/12:  44%|████▍     | 185/420 [00:22<00:30,  7.65it/s, loss:1.50453]Epoch 6/12:  45%|████▌     | 190/420 [00:22<00:28,  8.06it/s, loss:1.50453]Epoch 6/12:  45%|████▌     | 190/420 [00:22<00:28,  8.06it/s, loss:1.49136]Epoch 6/12:  46%|████▋     | 195/420 [00:23<00:26,  8.51it/s, loss:1.49136]Epoch 6/12:  46%|████▋     | 195/420 [00:23<00:26,  8.51it/s, loss:1.75699]Epoch 6/12:  48%|████▊     | 200/420 [00:23<00:24,  8.87it/s, loss:1.75699]Epoch 6/12:  48%|████▊     | 200/420 [00:23<00:24,  8.87it/s, loss:1.91617]Epoch 6/12:  49%|████▉     | 205/420 [00:24<00:23,  9.10it/s, loss:1.91617]Epoch 6/12:  49%|████▉     | 205/420 [00:24<00:23,  9.10it/s, loss:1.85683]Epoch 6/12:  50%|█████     | 210/420 [00:24<00:22,  9.52it/s, loss:1.85683]Epoch 6/12:  50%|█████     | 210/420 [00:24<00:22,  9.52it/s, loss:1.70321]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.37it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.58it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.14it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.38it/s][A
                                                   [A                                                                           Epoch 6/12:  50%|█████     | 210/420 [00:25<00:22,  9.52it/s, loss:1.70321]                                                                           Epoch 6/12:  50%|█████     | 210/420 [00:25<00:22,  9.52it/s, loss:1.70321]                                                                           Epoch 6/12:  50%|█████     | 210/420 [00:25<00:22,  9.52it/s, loss:1.70321]Epoch 7/12:  50%|█████     | 210/420 [00:25<00:22,  9.52it/s, loss:1.70321]Epoch 7/12:  51%|█████     | 215/420 [00:25<00:26,  7.60it/s, loss:1.70321]Epoch 7/12:  51%|█████     | 215/420 [00:25<00:26,  7.60it/s, loss:1.79671]Epoch 7/12:  52%|█████▏    | 220/420 [00:26<00:24,  8.19it/s, loss:1.79671]Epoch 7/12:  52%|█████▏    | 220/420 [00:26<00:24,  8.19it/s, loss:1.60856]Epoch 7/12:  54%|█████▎    | 225/420 [00:26<00:22,  8.65it/s, loss:1.60856]Epoch 7/12:  54%|█████▎    | 225/420 [00:26<00:22,  8.65it/s, loss:1.70448]Epoch 7/12:  55%|█████▍    | 230/420 [00:27<00:21,  8.92it/s, loss:1.70448]Epoch 7/12:  55%|█████▍    | 230/420 [00:27<00:21,  8.92it/s, loss:1.62441]Epoch 7/12:  56%|█████▌    | 235/420 [00:27<00:20,  9.12it/s, loss:1.62441]Epoch 7/12:  56%|█████▌    | 235/420 [00:27<00:20,  9.12it/s, loss:1.70882]Epoch 7/12:  57%|█████▋    | 240/420 [00:28<00:19,  9.19it/s, loss:1.70882]Epoch 7/12:  57%|█████▋    | 240/420 [00:28<00:19,  9.19it/s, loss:1.71157]Epoch 7/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.54it/s, loss:1.71157]Epoch 7/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.54it/s, loss:1.70705]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.44it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.56it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.17it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.46it/s][A
                                                   [A                                                                           Epoch 7/12:  58%|█████▊    | 245/420 [00:29<00:18,  9.54it/s, loss:1.70705]                                                                           Epoch 7/12:  58%|█████▊    | 245/420 [00:29<00:18,  9.54it/s, loss:1.70705]                                                                           Epoch 7/12:  58%|█████▊    | 245/420 [00:29<00:18,  9.54it/s, loss:1.70705]Epoch 8/12:  58%|█████▊    | 245/420 [00:29<00:18,  9.54it/s, loss:1.70705]Epoch 8/12:  60%|█████▉    | 250/420 [00:29<00:22,  7.56it/s, loss:1.70705]Epoch 8/12:  60%|█████▉    | 250/420 [00:29<00:22,  7.56it/s, loss:1.63371]Epoch 8/12:  61%|██████    | 255/420 [00:30<00:20,  8.09it/s, loss:1.63371]Epoch 8/12:  61%|██████    | 255/420 [00:30<00:20,  8.09it/s, loss:1.61889]Epoch 8/12:  62%|██████▏   | 260/420 [00:30<00:18,  8.51it/s, loss:1.61889]Epoch 8/12:  62%|██████▏   | 260/420 [00:30<00:18,  8.51it/s, loss:1.47759]Epoch 8/12:  63%|██████▎   | 265/420 [00:31<00:17,  8.81it/s, loss:1.47759]Epoch 8/12:  63%|██████▎   | 265/420 [00:31<00:17,  8.81it/s, loss:1.66221]Epoch 8/12:  64%|██████▍   | 270/420 [00:31<00:16,  9.12it/s, loss:1.66221]Epoch 8/12:  64%|██████▍   | 270/420 [00:31<00:16,  9.12it/s, loss:1.49762]Epoch 8/12:  65%|██████▌   | 275/420 [00:32<00:15,  9.30it/s, loss:1.49762]Epoch 8/12:  65%|██████▌   | 275/420 [00:32<00:15,  9.30it/s, loss:1.63781]Epoch 8/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.66it/s, loss:1.63781]Epoch 8/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.66it/s, loss:1.56706]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.48it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.55it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.10it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.34it/s][A
                                                   [A                                                                           Epoch 8/12:  67%|██████▋   | 280/420 [00:33<00:14,  9.66it/s, loss:1.56706]                                                                           Epoch 8/12:  67%|██████▋   | 280/420 [00:33<00:14,  9.66it/s, loss:1.56706]                                                                           Epoch 8/12:  67%|██████▋   | 280/420 [00:33<00:14,  9.66it/s, loss:1.56706]Epoch 9/12:  67%|██████▋   | 280/420 [00:33<00:14,  9.66it/s, loss:1.56706]Epoch 9/12:  68%|██████▊   | 285/420 [00:33<00:17,  7.61it/s, loss:1.56706]Epoch 9/12:  68%|██████▊   | 285/420 [00:33<00:17,  7.61it/s, loss:1.57762]Epoch 9/12:  69%|██████▉   | 290/420 [00:34<00:15,  8.14it/s, loss:1.57762]Epoch 9/12:  69%|██████▉   | 290/420 [00:34<00:15,  8.14it/s, loss:1.59541]Epoch 9/12:  70%|███████   | 295/420 [00:34<00:14,  8.59it/s, loss:1.59541]Epoch 9/12:  70%|███████   | 295/420 [00:34<00:14,  8.59it/s, loss:1.44494]Epoch 9/12:  71%|███████▏  | 300/420 [00:35<00:13,  8.84it/s, loss:1.44494]Epoch 9/12:  71%|███████▏  | 300/420 [00:35<00:13,  8.84it/s, loss:1.40845]Epoch 9/12:  73%|███████▎  | 305/420 [00:35<00:12,  9.10it/s, loss:1.40845]Epoch 9/12:  73%|███████▎  | 305/420 [00:35<00:12,  9.10it/s, loss:1.84359]Epoch 9/12:  74%|███████▍  | 310/420 [00:36<00:11,  9.31it/s, loss:1.84359]Epoch 9/12:  74%|███████▍  | 310/420 [00:36<00:11,  9.31it/s, loss:1.46991]Epoch 9/12:  75%|███████▌  | 315/420 [00:36<00:10,  9.65it/s, loss:1.46991]Epoch 9/12:  75%|███████▌  | 315/420 [00:36<00:10,  9.65it/s, loss:1.57652]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.51it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.59it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.16it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.35it/s][A
                                                   [A                                                                           Epoch 9/12:  75%|███████▌  | 315/420 [00:37<00:10,  9.65it/s, loss:1.57652]                                                                           Epoch 9/12:  75%|███████▌  | 315/420 [00:37<00:10,  9.65it/s, loss:1.57652]                                                                           Epoch 9/12:  75%|███████▌  | 315/420 [00:37<00:10,  9.65it/s, loss:1.57652]Epoch 10/12:  75%|███████▌  | 315/420 [00:37<00:10,  9.65it/s, loss:1.57652]Epoch 10/12:  76%|███████▌  | 320/420 [00:37<00:13,  7.62it/s, loss:1.57652]Epoch 10/12:  76%|███████▌  | 320/420 [00:37<00:13,  7.62it/s, loss:1.51919]Epoch 10/12:  77%|███████▋  | 325/420 [00:38<00:11,  8.15it/s, loss:1.51919]Epoch 10/12:  77%|███████▋  | 325/420 [00:38<00:11,  8.15it/s, loss:1.42410]Epoch 10/12:  79%|███████▊  | 330/420 [00:38<00:10,  8.53it/s, loss:1.42410]Epoch 10/12:  79%|███████▊  | 330/420 [00:38<00:10,  8.53it/s, loss:1.44802]Epoch 10/12:  80%|███████▉  | 335/420 [00:39<00:09,  8.84it/s, loss:1.44802]Epoch 10/12:  80%|███████▉  | 335/420 [00:39<00:09,  8.84it/s, loss:1.62632]Epoch 10/12:  81%|████████  | 340/420 [00:39<00:08,  8.98it/s, loss:1.62632]Epoch 10/12:  81%|████████  | 340/420 [00:39<00:08,  8.98it/s, loss:1.73849]Epoch 10/12:  82%|████████▏ | 345/420 [00:40<00:08,  9.21it/s, loss:1.73849]Epoch 10/12:  82%|████████▏ | 345/420 [00:40<00:08,  9.21it/s, loss:1.58844]Epoch 10/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.63it/s, loss:1.58844]Epoch 10/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.63it/s, loss:1.45844]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.46it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.56it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.13it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.30it/s][A
                                                   [A                                                                            Epoch 10/12:  83%|████████▎ | 350/420 [00:41<00:07,  9.63it/s, loss:1.45844]                                                                            Epoch 10/12:  83%|████████▎ | 350/420 [00:41<00:07,  9.63it/s, loss:1.45844]                                                                            Epoch 10/12:  83%|████████▎ | 350/420 [00:41<00:07,  9.63it/s, loss:1.45844]Epoch 11/12:  83%|████████▎ | 350/420 [00:41<00:07,  9.63it/s, loss:1.45844]Epoch 11/12:  85%|████████▍ | 355/420 [00:41<00:08,  7.63it/s, loss:1.45844]Epoch 11/12:  85%|████████▍ | 355/420 [00:41<00:08,  7.63it/s, loss:1.47859]Epoch 11/12:  86%|████████▌ | 360/420 [00:42<00:07,  8.14it/s, loss:1.47859]Epoch 11/12:  86%|████████▌ | 360/420 [00:42<00:07,  8.14it/s, loss:1.42068]Epoch 11/12:  87%|████████▋ | 365/420 [00:42<00:06,  8.55it/s, loss:1.42068]Epoch 11/12:  87%|████████▋ | 365/420 [00:42<00:06,  8.55it/s, loss:1.47019]Epoch 11/12:  88%|████████▊ | 370/420 [00:43<00:05,  8.85it/s, loss:1.47019]Epoch 11/12:  88%|████████▊ | 370/420 [00:43<00:05,  8.85it/s, loss:1.50952]Epoch 11/12:  89%|████████▉ | 375/420 [00:43<00:04,  9.04it/s, loss:1.50952]Epoch 11/12:  89%|████████▉ | 375/420 [00:43<00:04,  9.04it/s, loss:1.56310]Epoch 11/12:  90%|█████████ | 380/420 [00:44<00:04,  9.16it/s, loss:1.56310]Epoch 11/12:  90%|█████████ | 380/420 [00:44<00:04,  9.16it/s, loss:1.61621]Epoch 11/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.58it/s, loss:1.61621]Epoch 11/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.58it/s, loss:1.53083]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.37it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.54it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.15it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.37it/s][A
                                                   [A                                                                            Epoch 11/12:  92%|█████████▏| 385/420 [00:45<00:03,  9.58it/s, loss:1.53083]                                                                            Epoch 11/12:  92%|█████████▏| 385/420 [00:45<00:03,  9.58it/s, loss:1.53083]                                                                            Epoch 11/12:  92%|█████████▏| 385/420 [00:45<00:03,  9.58it/s, loss:1.53083]Epoch 12/12:  92%|█████████▏| 385/420 [00:45<00:03,  9.58it/s, loss:1.53083]Epoch 12/12:  93%|█████████▎| 390/420 [00:45<00:03,  7.59it/s, loss:1.53083]Epoch 12/12:  93%|█████████▎| 390/420 [00:45<00:03,  7.59it/s, loss:1.36679]Epoch 12/12:  94%|█████████▍| 395/420 [00:46<00:03,  8.11it/s, loss:1.36679]Epoch 12/12:  94%|█████████▍| 395/420 [00:46<00:03,  8.11it/s, loss:1.51492]Epoch 12/12:  95%|█████████▌| 400/420 [00:46<00:02,  8.54it/s, loss:1.51492]Epoch 12/12:  95%|█████████▌| 400/420 [00:46<00:02,  8.54it/s, loss:1.29277]Epoch 12/12:  96%|█████████▋| 405/420 [00:47<00:01,  8.87it/s, loss:1.29277]Epoch 12/12:  96%|█████████▋| 405/420 [00:47<00:01,  8.87it/s, loss:1.27165]Epoch 12/12:  98%|█████████▊| 410/420 [00:47<00:01,  9.12it/s, loss:1.27165]Epoch 12/12:  98%|█████████▊| 410/420 [00:47<00:01,  9.12it/s, loss:1.66336]Epoch 12/12:  99%|█████████▉| 415/420 [00:48<00:00,  9.21it/s, loss:1.66336]Epoch 12/12:  99%|█████████▉| 415/420 [00:48<00:00,  9.21it/s, loss:1.39288]Epoch 12/12: 100%|██████████| 420/420 [00:48<00:00,  9.55it/s, loss:1.39288]Epoch 12/12: 100%|██████████| 420/420 [00:48<00:00,  9.55it/s, loss:1.76884]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  22%|██▏       | 2/9 [00:00<00:00, 19.34it/s][A
Test:  44%|████▍     | 4/9 [00:00<00:00, 19.52it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 19.13it/s][A
Test:  89%|████████▉ | 8/9 [00:00<00:00, 19.39it/s][A
                                                   [A                                                                            Epoch 12/12: 100%|██████████| 420/420 [00:49<00:00,  9.55it/s, loss:1.76884]                                                                            Epoch 12/12: 100%|██████████| 420/420 [00:49<00:00,  9.55it/s, loss:1.76884]                                                                            Epoch 12/12: 100%|██████████| 420/420 [00:49<00:00,  9.55it/s, loss:1.76884]                                                                            /home/rockyo/anaconda3/envs/aicup/lib/python3.7/site-packages/fastNLP/embeddings/bert_embedding.py:430: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  self.word_to_wordpieces = np.array(word_to_wordpieces)
  0%|          | 0/420 [00:00<?, ?it/s, loss:{0:<6.5f}]Epoch 1/12:   0%|          | 0/420 [00:00<?, ?it/s, loss:{0:<6.5f}]Epoch 1/12:   1%|          | 5/420 [00:00<00:42,  9.85it/s, loss:{0:<6.5f}]Epoch 1/12:   1%|          | 5/420 [00:00<00:42,  9.85it/s, loss:2.01144]  Epoch 1/12:   2%|▏         | 10/420 [00:01<00:41,  9.77it/s, loss:2.01144]Epoch 1/12:   2%|▏         | 10/420 [00:01<00:41,  9.77it/s, loss:1.91861]Epoch 1/12:   4%|▎         | 15/420 [00:01<00:40,  9.95it/s, loss:1.91861]Epoch 1/12:   4%|▎         | 15/420 [00:01<00:40,  9.95it/s, loss:1.92471]Epoch 1/12:   5%|▍         | 20/420 [00:02<00:40,  9.76it/s, loss:1.92471]Epoch 1/12:   5%|▍         | 20/420 [00:02<00:40,  9.76it/s, loss:1.90112]Epoch 1/12:   6%|▌         | 25/420 [00:02<00:40,  9.70it/s, loss:1.90112]Epoch 1/12:   6%|▌         | 25/420 [00:02<00:40,  9.70it/s, loss:1.91767]Epoch 1/12:   7%|▋         | 30/420 [00:03<00:40,  9.63it/s, loss:1.91767]Epoch 1/12:   7%|▋         | 30/420 [00:03<00:40,  9.63it/s, loss:1.89031]Epoch 1/12:   8%|▊         | 35/420 [00:03<00:39,  9.85it/s, loss:1.89031]Epoch 1/12:   8%|▊         | 35/420 [00:03<00:39,  9.85it/s, loss:1.90817]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 20.83it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.70it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 21.26it/s][A
                                                   [A                                                                          Epoch 1/12:   8%|▊         | 35/420 [00:04<00:39,  9.85it/s, loss:1.90817]                                                                          Epoch 1/12:   8%|▊         | 35/420 [00:04<00:39,  9.85it/s, loss:1.90817]                                                                          Epoch 1/12:   8%|▊         | 35/420 [00:04<00:39,  9.85it/s, loss:1.90817]/home/rockyo/anaconda3/envs/aicup/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:154: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch 2/12:   8%|▊         | 35/420 [00:04<00:39,  9.85it/s, loss:1.90817]Epoch 2/12:  10%|▉         | 40/420 [00:04<00:53,  7.09it/s, loss:1.90817]Epoch 2/12:  10%|▉         | 40/420 [00:04<00:53,  7.09it/s, loss:1.91438]Epoch 2/12:  11%|█         | 45/420 [00:05<00:48,  7.76it/s, loss:1.91438]Epoch 2/12:  11%|█         | 45/420 [00:05<00:48,  7.76it/s, loss:1.87648]Epoch 2/12:  12%|█▏        | 50/420 [00:05<00:44,  8.30it/s, loss:1.87648]Epoch 2/12:  12%|█▏        | 50/420 [00:05<00:44,  8.30it/s, loss:1.89165]Epoch 2/12:  13%|█▎        | 55/420 [00:06<00:42,  8.67it/s, loss:1.89165]Epoch 2/12:  13%|█▎        | 55/420 [00:06<00:42,  8.67it/s, loss:1.89729]Epoch 2/12:  14%|█▍        | 60/420 [00:06<00:40,  8.94it/s, loss:1.89729]Epoch 2/12:  14%|█▍        | 60/420 [00:06<00:40,  8.94it/s, loss:1.86799]Epoch 2/12:  15%|█▌        | 65/420 [00:07<00:38,  9.26it/s, loss:1.86799]Epoch 2/12:  15%|█▌        | 65/420 [00:07<00:38,  9.26it/s, loss:1.93816]Epoch 2/12:  17%|█▋        | 70/420 [00:07<00:36,  9.53it/s, loss:1.93816]Epoch 2/12:  17%|█▋        | 70/420 [00:07<00:36,  9.53it/s, loss:1.84158]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 20.82it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.75it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 21.29it/s][A
                                                   [A                                                                          Epoch 2/12:  17%|█▋        | 70/420 [00:08<00:36,  9.53it/s, loss:1.84158]                                                                          Epoch 2/12:  17%|█▋        | 70/420 [00:08<00:36,  9.53it/s, loss:1.84158]                                                                          Epoch 2/12:  17%|█▋        | 70/420 [00:08<00:36,  9.53it/s, loss:1.84158]Epoch 3/12:  17%|█▋        | 70/420 [00:08<00:36,  9.53it/s, loss:1.84158]Epoch 3/12:  18%|█▊        | 75/420 [00:08<00:48,  7.05it/s, loss:1.84158]Epoch 3/12:  18%|█▊        | 75/420 [00:08<00:48,  7.05it/s, loss:1.91966]Epoch 3/12:  19%|█▉        | 80/420 [00:09<00:44,  7.65it/s, loss:1.91966]Epoch 3/12:  19%|█▉        | 80/420 [00:09<00:44,  7.65it/s, loss:1.87840]Epoch 3/12:  20%|██        | 85/420 [00:09<00:40,  8.17it/s, loss:1.87840]Epoch 3/12:  20%|██        | 85/420 [00:09<00:40,  8.17it/s, loss:1.84344]Epoch 3/12:  21%|██▏       | 90/420 [00:10<00:38,  8.57it/s, loss:1.84344]Epoch 3/12:  21%|██▏       | 90/420 [00:10<00:38,  8.57it/s, loss:1.81752]Epoch 3/12:  23%|██▎       | 95/420 [00:10<00:36,  8.89it/s, loss:1.81752]Epoch 3/12:  23%|██▎       | 95/420 [00:10<00:36,  8.89it/s, loss:1.80256]Epoch 3/12:  24%|██▍       | 100/420 [00:11<00:35,  9.08it/s, loss:1.80256]Epoch 3/12:  24%|██▍       | 100/420 [00:11<00:35,  9.08it/s, loss:1.81858]Epoch 3/12:  25%|██▌       | 105/420 [00:11<00:33,  9.44it/s, loss:1.81858]Epoch 3/12:  25%|██▌       | 105/420 [00:11<00:33,  9.44it/s, loss:1.75177]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 20.69it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.64it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 21.14it/s][A
                                                   [A                                                                           Epoch 3/12:  25%|██▌       | 105/420 [00:12<00:33,  9.44it/s, loss:1.75177]                                                                           Epoch 3/12:  25%|██▌       | 105/420 [00:12<00:33,  9.44it/s, loss:1.75177]                                                                           Epoch 3/12:  25%|██▌       | 105/420 [00:12<00:33,  9.44it/s, loss:1.75177]Epoch 4/12:  25%|██▌       | 105/420 [00:12<00:33,  9.44it/s, loss:1.75177]Epoch 4/12:  26%|██▌       | 110/420 [00:13<00:44,  7.01it/s, loss:1.75177]Epoch 4/12:  26%|██▌       | 110/420 [00:13<00:44,  7.01it/s, loss:1.76640]Epoch 4/12:  27%|██▋       | 115/420 [00:13<00:40,  7.62it/s, loss:1.76640]Epoch 4/12:  27%|██▋       | 115/420 [00:13<00:40,  7.62it/s, loss:1.78674]Epoch 4/12:  29%|██▊       | 120/420 [00:14<00:36,  8.12it/s, loss:1.78674]Epoch 4/12:  29%|██▊       | 120/420 [00:14<00:36,  8.12it/s, loss:1.84615]Epoch 4/12:  30%|██▉       | 125/420 [00:14<00:34,  8.51it/s, loss:1.84615]Epoch 4/12:  30%|██▉       | 125/420 [00:14<00:34,  8.51it/s, loss:1.78440]Epoch 4/12:  31%|███       | 130/420 [00:15<00:32,  8.89it/s, loss:1.78440]Epoch 4/12:  31%|███       | 130/420 [00:15<00:32,  8.89it/s, loss:1.81292]Epoch 4/12:  32%|███▏      | 135/420 [00:15<00:31,  9.01it/s, loss:1.81292]Epoch 4/12:  32%|███▏      | 135/420 [00:15<00:31,  9.01it/s, loss:1.73695]Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.48it/s, loss:1.73695]Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.48it/s, loss:1.75755]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 20.72it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.67it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 21.23it/s][A
                                                   [A                                                                           Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.48it/s, loss:1.75755]                                                                           Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.48it/s, loss:1.75755]                                                                           Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.48it/s, loss:1.75755]Epoch 5/12:  33%|███▎      | 140/420 [00:16<00:29,  9.48it/s, loss:1.75755]Epoch 5/12:  35%|███▍      | 145/420 [00:17<00:39,  7.01it/s, loss:1.75755]Epoch 5/12:  35%|███▍      | 145/420 [00:17<00:39,  7.01it/s, loss:1.73103]Epoch 5/12:  36%|███▌      | 150/420 [00:17<00:35,  7.65it/s, loss:1.73103]Epoch 5/12:  36%|███▌      | 150/420 [00:17<00:35,  7.65it/s, loss:1.76475]Epoch 5/12:  37%|███▋      | 155/420 [00:18<00:32,  8.17it/s, loss:1.76475]Epoch 5/12:  37%|███▋      | 155/420 [00:18<00:32,  8.17it/s, loss:1.83969]Epoch 5/12:  38%|███▊      | 160/420 [00:18<00:30,  8.60it/s, loss:1.83969]Epoch 5/12:  38%|███▊      | 160/420 [00:18<00:30,  8.60it/s, loss:1.63336]Epoch 5/12:  39%|███▉      | 165/420 [00:19<00:28,  8.81it/s, loss:1.63336]Epoch 5/12:  39%|███▉      | 165/420 [00:19<00:28,  8.81it/s, loss:1.73541]Epoch 5/12:  40%|████      | 170/420 [00:19<00:27,  9.08it/s, loss:1.73541]Epoch 5/12:  40%|████      | 170/420 [00:19<00:27,  9.08it/s, loss:1.75905]Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:26,  9.39it/s, loss:1.75905]Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:26,  9.39it/s, loss:1.65170]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 20.74it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.67it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 21.17it/s][A
                                                   [A                                                                           Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:26,  9.39it/s, loss:1.65170]                                                                           Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:26,  9.39it/s, loss:1.65170]                                                                           Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:26,  9.39it/s, loss:1.65170]Epoch 6/12:  42%|████▏     | 175/420 [00:20<00:26,  9.39it/s, loss:1.65170]Epoch 6/12:  43%|████▎     | 180/420 [00:21<00:31,  7.61it/s, loss:1.65170]Epoch 6/12:  43%|████▎     | 180/420 [00:21<00:31,  7.61it/s, loss:1.68895]Epoch 6/12:  44%|████▍     | 185/420 [00:21<00:28,  8.13it/s, loss:1.68895]Epoch 6/12:  44%|████▍     | 185/420 [00:21<00:28,  8.13it/s, loss:1.79809]Epoch 6/12:  45%|████▌     | 190/420 [00:22<00:26,  8.56it/s, loss:1.79809]Epoch 6/12:  45%|████▌     | 190/420 [00:22<00:26,  8.56it/s, loss:1.65951]Epoch 6/12:  46%|████▋     | 195/420 [00:22<00:25,  8.94it/s, loss:1.65951]Epoch 6/12:  46%|████▋     | 195/420 [00:22<00:25,  8.94it/s, loss:1.64731]Epoch 6/12:  48%|████▊     | 200/420 [00:23<00:24,  9.12it/s, loss:1.64731]Epoch 6/12:  48%|████▊     | 200/420 [00:23<00:24,  9.12it/s, loss:1.74522]Epoch 6/12:  49%|████▉     | 205/420 [00:23<00:23,  9.24it/s, loss:1.74522]Epoch 6/12:  49%|████▉     | 205/420 [00:23<00:23,  9.24it/s, loss:1.65268]Epoch 6/12:  50%|█████     | 210/420 [00:24<00:22,  9.51it/s, loss:1.65268]Epoch 6/12:  50%|█████     | 210/420 [00:24<00:22,  9.51it/s, loss:1.55670]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 20.69it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.57it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 21.08it/s][A
                                                   [A                                                                           Epoch 6/12:  50%|█████     | 210/420 [00:24<00:22,  9.51it/s, loss:1.55670]                                                                           
AccuracyMetric: acc=0.471014
Acc_loss_Metric: val_loss=1.867861
ClassifyFPreRecMetric: f=0.334967, pre=0.335335, rec=0.393597

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 5/12. Step:175/420: 
AccuracyMetric: acc=0.492754
Acc_loss_Metric: val_loss=1.860386
ClassifyFPreRecMetric: f=0.358638, pre=0.332887, rec=0.417577

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 6/12. Step:210/420: 
AccuracyMetric: acc=0.463768
Acc_loss_Metric: val_loss=2.036586
ClassifyFPreRecMetric: f=0.350741, pre=0.31075, rec=0.403766

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 7/12. Step:245/420: 
AccuracyMetric: acc=0.463768
Acc_loss_Metric: val_loss=1.89163
ClassifyFPreRecMetric: f=0.333853, pre=0.662978, rec=0.386828

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 8/12. Step:280/420: 
AccuracyMetric: acc=0.492754
Acc_loss_Metric: val_loss=1.932803
ClassifyFPreRecMetric: f=0.361883, pre=0.438384, rec=0.412943

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 9/12. Step:315/420: 
AccuracyMetric: acc=0.485507
Acc_loss_Metric: val_loss=1.977222
ClassifyFPreRecMetric: f=0.351143, pre=0.340028, rec=0.408412

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 10/12. Step:350/420: 
AccuracyMetric: acc=0.485507
Acc_loss_Metric: val_loss=2.11497
ClassifyFPreRecMetric: f=0.348148, pre=0.350684, rec=0.406654

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 11/12. Step:385/420: 
AccuracyMetric: acc=0.434783
Acc_loss_Metric: val_loss=1.947921
ClassifyFPreRecMetric: f=0.296668, pre=0.302695, rec=0.358318

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 12/12. Step:420/420: 
AccuracyMetric: acc=0.492754
Acc_loss_Metric: val_loss=2.053563
ClassifyFPreRecMetric: f=0.366432, pre=0.334325, rec=0.42285

Reloaded the best model.

In Epoch:3/Step:105, got best dev performance:
AccuracyMetric: acc=0.514493
Acc_loss_Metric: val_loss=1.81236
ClassifyFPreRecMetric: f=0.375789, pre=0.351852, rec=0.436284
Visualization...
[2, 2, 2, 2, 2, 2, 2, 0, 0, 2, 0, 0, 2, 2, 2, 0, 2, 0, 0, 2]
acc 0.5145
Predicting dev...
writing pred1.npy...
[34mAuto commit by fitlog[0m
--------Fold2----------
Found 7550 out of 10306 words in the pre-training embedding.
loading vocabulary file /home/rockyo/.fastNLP/embedding/bert-chinese-wwm-ext/vocab.txt
The transformer encoder will early exit after layer-1 (start from 0)!
Load pre-trained BERT parameters from file /home/rockyo/.fastNLP/embedding/bert-chinese-wwm-ext/pytorch_model.bin.
input fields after batch(if batch size is 2):
	raw_text: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 3, 169]) 
	cho: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 3, 21]) 
	q: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 12]) 
	target_onehot: (1)type:torch.Tensor (2)dtype:torch.float32, (3)shape:torch.Size([2, 3]) 
	roleid: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 3, 169]) 
	q_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 
target fields after batch(if batch size is 2):
	target: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 

training epochs started 2021-06-17-01-01-52-224434
Evaluate data in 0.45 seconds!
Evaluation on dev at Epoch 1/12. Step:35/420: 
AccuracyMetric: acc=0.338028
Acc_loss_Metric: val_loss=1.907197
ClassifyFPreRecMetric: f=0.168421, pre=0.112676, rec=0.333333

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 2/12. Step:70/420: 
AccuracyMetric: acc=0.422535
Acc_loss_Metric: val_loss=1.897386
ClassifyFPreRecMetric: f=0.320812, pre=0.307164, rec=0.401235

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 3/12. Step:105/420: 
AccuracyMetric: acc=0.429577
Acc_loss_Metric: val_loss=1.918153
ClassifyFPreRecMetric: f=0.325637, pre=0.314116, rec=0.408179

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 4/12. Step:140/420: 
AccuracyMetric: acc=0.43662
Acc_loss_Metric: val_loss=2.140579
ClassifyFPreRecMetric: f=0.335398, pre=0.31254, rec=0.412809

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 5/12. Step:175/420: 
AccuracyMetric: acc=0.464789
Acc_loss_Metric: val_loss=1.877029
ClassifyFPreRecMetric: f=0.356197, pre=0.3625, rec=0.441358

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 6/12. Step:210/420: 
AccuracyMetric: acc=0.43662
Acc_loss_Metric: val_loss=1.882523
ClassifyFPreRecMetric: f=0.33903, pre=0.296372, rec=0.408179

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 7/12. Step:245/420: 
AccuracyMetric: acc=0.373239
Acc_loss_Metric: val_loss=2.052126
ClassifyFPreRecMetric: f=0.278436, pre=0.261604, rec=0.35571

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 8/12. Step:280/420: 
AccuracyMetric: acc=0.422535
Acc_loss_Metric: val_loss=2.127215
ClassifyFPreRecMetric: f=0.325275, pre=0.290435, rec=0.398148

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 9/12. Step:315/420: 
AccuracyMetric: acc=0.380282
Acc_loss_Metric: val_loss=2.082481
ClassifyFPreRecMetric: f=0.274685, pre=0.279334, rec=0.364969

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 10/12. Step:350/420: 
AccuracyMetric: acc=0.429577
Acc_loss_Metric: val_loss=2.007193
ClassifyFPreRecMetric: f=0.330893, pre=0.309206, rec=0.405864

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 11/12. Step:385/420: 
AccuracyMetric: acc=0.408451
Acc_loss_Metric: val_loss=2.031052
ClassifyFPreRecMetric: f=0.324384, pre=0.456667, rec=0.388735

Evaluate data in 0.46 seconds!
Evaluation on dev at Epoch 12/12. Step:420/420: 
AccuracyMetric: acc=0.373239
Acc_loss_Metric: val_loss=2.133557
ClassifyFPreRecMetric: f=0.288624, pre=0.490942, rec=0.362346

Reloaded the best model.

In Epoch:5/Step:175, got best dev performance:
AccuracyMetric: acc=0.464789
Acc_loss_Metric: val_loss=1.877029
ClassifyFPreRecMetric: f=0.356197, pre=0.3625, rec=0.441358
Visualization...
[0, 2, 2, 0, 2, 0, 2, 0, 2, 2, 2, 2, 2, 2, 0, 0, 2, 2, 2, 2]
acc 0.4648
Predicting dev...
writing pred2.npy...
[34mAuto commit by fitlog[0m
--------Fold3----------
Found 7550 out of 10306 words in the pre-training embedding.
loading vocabulary file /home/rockyo/.fastNLP/embedding/bert-chinese-wwm-ext/vocab.txt
The transformer encoder will early exit after layer-1 (start from 0)!
Load pre-trained BERT parameters from file /home/rockyo/.fastNLP/embedding/bert-chinese-wwm-ext/pytorch_model.bin.
input fields after batch(if batch size is 2):
	raw_text: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 3, 177]) 
	cho: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 3, 21]) 
	q: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 12]) 
	target_onehot: (1)type:torch.Tensor (2)dtype:torch.float32, (3)shape:torch.Size([2, 3]) 
	roleid: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 3, 177]) 
	q_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 
target fields after batch(if batch size is 2):
	target: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 

training epochs started 2021-06-17-01-03-14-299313
Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 1/12. Step:35/420: 
AccuracyMetric: acc=0.385714
Acc_loss_Metric: val_loss=1.902252
ClassifyFPreRecMetric: f=0.293623, pre=0.274232, rec=0.373726

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 2/12. Step:70/420: 
AccuracyMetric: acc=0.457143
Acc_loss_Metric: val_loss=1.869155
ClassifyFPreRecMetric: f=0.346768, pre=0.302869, rec=0.41244

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 3/12. Step:105/420: 
AccuracyMetric: acc=0.521429
Acc_loss_Metric: val_loss=1.807991
ClassifyFPreRecMetric: f=0.392301, pre=0.344444, rec=0.45722

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 4/12. Step:140/420: 
AccuracyMetric: acc=0.542857
Acc_loss_Metric: val_loss=1.771749
ClassifyFPreRecMetric: f=0.411891, pre=0.358346, rec=0.48445

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 5/12. Step:175/420: 
AccuracyMetric: acc=0.5
Acc_loss_Metric: val_loss=1.865151
ClassifyFPreRecMetric: f=0.367212, pre=0.33622, rec=0.424313

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 6/12. Step:210/420: Epoch 6/12:  50%|█████     | 210/420 [00:24<00:22,  9.51it/s, loss:1.55670]                                                                           Epoch 6/12:  50%|█████     | 210/420 [00:24<00:22,  9.51it/s, loss:1.55670]Epoch 7/12:  50%|█████     | 210/420 [00:24<00:22,  9.51it/s, loss:1.55670]Epoch 7/12:  51%|█████     | 215/420 [00:25<00:26,  7.63it/s, loss:1.55670]Epoch 7/12:  51%|█████     | 215/420 [00:25<00:26,  7.63it/s, loss:1.71176]Epoch 7/12:  52%|█████▏    | 220/420 [00:25<00:24,  8.11it/s, loss:1.71176]Epoch 7/12:  52%|█████▏    | 220/420 [00:25<00:24,  8.11it/s, loss:1.65336]Epoch 7/12:  54%|█████▎    | 225/420 [00:26<00:23,  8.47it/s, loss:1.65336]Epoch 7/12:  54%|█████▎    | 225/420 [00:26<00:23,  8.47it/s, loss:1.72012]Epoch 7/12:  55%|█████▍    | 230/420 [00:26<00:21,  8.82it/s, loss:1.72012]Epoch 7/12:  55%|█████▍    | 230/420 [00:26<00:21,  8.82it/s, loss:1.61984]Epoch 7/12:  56%|█████▌    | 235/420 [00:27<00:20,  9.09it/s, loss:1.61984]Epoch 7/12:  56%|█████▌    | 235/420 [00:27<00:20,  9.09it/s, loss:1.65550]Epoch 7/12:  57%|█████▋    | 240/420 [00:27<00:19,  9.28it/s, loss:1.65550]Epoch 7/12:  57%|█████▋    | 240/420 [00:27<00:19,  9.28it/s, loss:1.77681]Epoch 7/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.53it/s, loss:1.77681]Epoch 7/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.53it/s, loss:1.55618]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 20.70it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.57it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 21.07it/s][A
                                                   [A                                                                           Epoch 7/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.53it/s, loss:1.55618]                                                                           Epoch 7/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.53it/s, loss:1.55618]                                                                           Epoch 7/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.53it/s, loss:1.55618]Epoch 8/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.53it/s, loss:1.55618]Epoch 8/12:  60%|█████▉    | 250/420 [00:29<00:22,  7.68it/s, loss:1.55618]Epoch 8/12:  60%|█████▉    | 250/420 [00:29<00:22,  7.68it/s, loss:1.69182]Epoch 8/12:  61%|██████    | 255/420 [00:29<00:20,  8.18it/s, loss:1.69182]Epoch 8/12:  61%|██████    | 255/420 [00:29<00:20,  8.18it/s, loss:1.76909]Epoch 8/12:  62%|██████▏   | 260/420 [00:30<00:18,  8.52it/s, loss:1.76909]Epoch 8/12:  62%|██████▏   | 260/420 [00:30<00:18,  8.52it/s, loss:1.77736]Epoch 8/12:  63%|██████▎   | 265/420 [00:30<00:17,  8.87it/s, loss:1.77736]Epoch 8/12:  63%|██████▎   | 265/420 [00:30<00:17,  8.87it/s, loss:1.82155]Epoch 8/12:  64%|██████▍   | 270/420 [00:31<00:16,  9.07it/s, loss:1.82155]Epoch 8/12:  64%|██████▍   | 270/420 [00:31<00:16,  9.07it/s, loss:1.88289]Epoch 8/12:  65%|██████▌   | 275/420 [00:31<00:15,  9.25it/s, loss:1.88289]Epoch 8/12:  65%|██████▌   | 275/420 [00:31<00:15,  9.25it/s, loss:1.80172]Epoch 8/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.57it/s, loss:1.80172]Epoch 8/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.57it/s, loss:1.73932]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 20.66it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.62it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 21.11it/s][A
                                                   [A                                                                           Epoch 8/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.57it/s, loss:1.73932]                                                                           Epoch 8/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.57it/s, loss:1.73932]                                                                           Epoch 8/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.57it/s, loss:1.73932]Epoch 9/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.57it/s, loss:1.73932]Epoch 9/12:  68%|██████▊   | 285/420 [00:33<00:17,  7.74it/s, loss:1.73932]Epoch 9/12:  68%|██████▊   | 285/420 [00:33<00:17,  7.74it/s, loss:1.66955]Epoch 9/12:  69%|██████▉   | 290/420 [00:33<00:15,  8.22it/s, loss:1.66955]Epoch 9/12:  69%|██████▉   | 290/420 [00:33<00:15,  8.22it/s, loss:1.80507]Epoch 9/12:  70%|███████   | 295/420 [00:34<00:14,  8.61it/s, loss:1.80507]Epoch 9/12:  70%|███████   | 295/420 [00:34<00:14,  8.61it/s, loss:1.66292]Epoch 9/12:  71%|███████▏  | 300/420 [00:34<00:13,  8.90it/s, loss:1.66292]Epoch 9/12:  71%|███████▏  | 300/420 [00:34<00:13,  8.90it/s, loss:1.76662]Epoch 9/12:  73%|███████▎  | 305/420 [00:35<00:12,  9.11it/s, loss:1.76662]Epoch 9/12:  73%|███████▎  | 305/420 [00:35<00:12,  9.11it/s, loss:1.71439]Epoch 9/12:  74%|███████▍  | 310/420 [00:36<00:11,  9.20it/s, loss:1.71439]Epoch 9/12:  74%|███████▍  | 310/420 [00:36<00:11,  9.20it/s, loss:1.39992]Epoch 9/12:  75%|███████▌  | 315/420 [00:36<00:11,  9.45it/s, loss:1.39992]Epoch 9/12:  75%|███████▌  | 315/420 [00:36<00:11,  9.45it/s, loss:1.75914]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 20.98it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.78it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 21.37it/s][A
                                                   [A                                                                           Epoch 9/12:  75%|███████▌  | 315/420 [00:36<00:11,  9.45it/s, loss:1.75914]                                                                           Epoch 9/12:  75%|███████▌  | 315/420 [00:36<00:11,  9.45it/s, loss:1.75914]                                                                           Epoch 9/12:  75%|███████▌  | 315/420 [00:36<00:11,  9.45it/s, loss:1.75914]Epoch 10/12:  75%|███████▌  | 315/420 [00:36<00:11,  9.45it/s, loss:1.75914]Epoch 10/12:  76%|███████▌  | 320/420 [00:37<00:12,  7.69it/s, loss:1.75914]Epoch 10/12:  76%|███████▌  | 320/420 [00:37<00:12,  7.69it/s, loss:1.66344]Epoch 10/12:  77%|███████▋  | 325/420 [00:37<00:11,  8.17it/s, loss:1.66344]Epoch 10/12:  77%|███████▋  | 325/420 [00:37<00:11,  8.17it/s, loss:1.53082]Epoch 10/12:  79%|███████▊  | 330/420 [00:38<00:10,  8.50it/s, loss:1.53082]Epoch 10/12:  79%|███████▊  | 330/420 [00:38<00:10,  8.50it/s, loss:1.60542]Epoch 10/12:  80%|███████▉  | 335/420 [00:39<00:09,  8.81it/s, loss:1.60542]Epoch 10/12:  80%|███████▉  | 335/420 [00:39<00:09,  8.81it/s, loss:1.77643]Epoch 10/12:  81%|████████  | 340/420 [00:39<00:08,  9.09it/s, loss:1.77643]Epoch 10/12:  81%|████████  | 340/420 [00:39<00:08,  9.09it/s, loss:1.64286]Epoch 10/12:  82%|████████▏ | 345/420 [00:40<00:08,  9.21it/s, loss:1.64286]Epoch 10/12:  82%|████████▏ | 345/420 [00:40<00:08,  9.21it/s, loss:1.69688]Epoch 10/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.62it/s, loss:1.69688]Epoch 10/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.62it/s, loss:1.68745]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 20.81it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.90it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 21.40it/s][A
                                                   [A                                                                            Epoch 10/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.62it/s, loss:1.68745]                                                                            Epoch 10/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.62it/s, loss:1.68745]                                                                            Epoch 10/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.62it/s, loss:1.68745]Epoch 11/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.62it/s, loss:1.68745]Epoch 11/12:  85%|████████▍ | 355/420 [00:41<00:08,  7.71it/s, loss:1.68745]Epoch 11/12:  85%|████████▍ | 355/420 [00:41<00:08,  7.71it/s, loss:1.71393]Epoch 11/12:  86%|████████▌ | 360/420 [00:41<00:07,  8.14it/s, loss:1.71393]Epoch 11/12:  86%|████████▌ | 360/420 [00:41<00:07,  8.14it/s, loss:1.63817]Epoch 11/12:  87%|████████▋ | 365/420 [00:42<00:06,  8.54it/s, loss:1.63817]Epoch 11/12:  87%|████████▋ | 365/420 [00:42<00:06,  8.54it/s, loss:1.70750]Epoch 11/12:  88%|████████▊ | 370/420 [00:43<00:05,  8.83it/s, loss:1.70750]Epoch 11/12:  88%|████████▊ | 370/420 [00:43<00:05,  8.83it/s, loss:1.60146]Epoch 11/12:  89%|████████▉ | 375/420 [00:43<00:04,  9.08it/s, loss:1.60146]Epoch 11/12:  89%|████████▉ | 375/420 [00:43<00:04,  9.08it/s, loss:1.74262]Epoch 11/12:  90%|█████████ | 380/420 [00:44<00:04,  9.20it/s, loss:1.74262]Epoch 11/12:  90%|█████████ | 380/420 [00:44<00:04,  9.20it/s, loss:1.71721]Epoch 11/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.56it/s, loss:1.71721]Epoch 11/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.56it/s, loss:1.50033]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 20.78it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.85it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 21.36it/s][A
                                                   [A                                                                            Epoch 11/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.56it/s, loss:1.50033]                                                                            Epoch 11/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.56it/s, loss:1.50033]                                                                            Epoch 11/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.56it/s, loss:1.50033]Epoch 12/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.56it/s, loss:1.50033]Epoch 12/12:  93%|█████████▎| 390/420 [00:45<00:03,  7.68it/s, loss:1.50033]Epoch 12/12:  93%|█████████▎| 390/420 [00:45<00:03,  7.68it/s, loss:1.46940]Epoch 12/12:  94%|█████████▍| 395/420 [00:46<00:03,  8.14it/s, loss:1.46940]Epoch 12/12:  94%|█████████▍| 395/420 [00:46<00:03,  8.14it/s, loss:1.57042]Epoch 12/12:  95%|█████████▌| 400/420 [00:46<00:02,  8.54it/s, loss:1.57042]Epoch 12/12:  95%|█████████▌| 400/420 [00:46<00:02,  8.54it/s, loss:1.50281]Epoch 12/12:  96%|█████████▋| 405/420 [00:47<00:01,  8.87it/s, loss:1.50281]Epoch 12/12:  96%|█████████▋| 405/420 [00:47<00:01,  8.87it/s, loss:1.62065]Epoch 12/12:  98%|█████████▊| 410/420 [00:47<00:01,  9.05it/s, loss:1.62065]Epoch 12/12:  98%|█████████▊| 410/420 [00:47<00:01,  9.05it/s, loss:1.51795]Epoch 12/12:  99%|█████████▉| 415/420 [00:48<00:00,  9.29it/s, loss:1.51795]Epoch 12/12:  99%|█████████▉| 415/420 [00:48<00:00,  9.29it/s, loss:1.49013]Epoch 12/12: 100%|██████████| 420/420 [00:48<00:00,  9.62it/s, loss:1.49013]Epoch 12/12: 100%|██████████| 420/420 [00:48<00:00,  9.62it/s, loss:1.62261]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 20.77it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.87it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 21.35it/s][A
                                                   [A                                                                            Epoch 12/12: 100%|██████████| 420/420 [00:48<00:00,  9.62it/s, loss:1.62261]                                                                            Epoch 12/12: 100%|██████████| 420/420 [00:48<00:00,  9.62it/s, loss:1.62261]                                                                            Epoch 12/12: 100%|██████████| 420/420 [00:48<00:00,  9.62it/s, loss:1.62261]                                                                            /home/rockyo/anaconda3/envs/aicup/lib/python3.7/site-packages/fastNLP/embeddings/bert_embedding.py:430: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  self.word_to_wordpieces = np.array(word_to_wordpieces)
  0%|          | 0/420 [00:00<?, ?it/s, loss:{0:<6.5f}]Epoch 1/12:   0%|          | 0/420 [00:00<?, ?it/s, loss:{0:<6.5f}]Epoch 1/12:   1%|          | 5/420 [00:00<00:41,  9.97it/s, loss:{0:<6.5f}]Epoch 1/12:   1%|          | 5/420 [00:00<00:41,  9.97it/s, loss:2.06381]  Epoch 1/12:   2%|▏         | 10/420 [00:01<00:42,  9.75it/s, loss:2.06381]Epoch 1/12:   2%|▏         | 10/420 [00:01<00:42,  9.75it/s, loss:1.91807]Epoch 1/12:   4%|▎         | 15/420 [00:01<00:41,  9.73it/s, loss:1.91807]Epoch 1/12:   4%|▎         | 15/420 [00:01<00:41,  9.73it/s, loss:1.93882]Epoch 1/12:   5%|▍         | 20/420 [00:02<00:40,  9.78it/s, loss:1.93882]Epoch 1/12:   5%|▍         | 20/420 [00:02<00:40,  9.78it/s, loss:1.88146]Epoch 1/12:   6%|▌         | 25/420 [00:02<00:40,  9.80it/s, loss:1.88146]Epoch 1/12:   6%|▌         | 25/420 [00:02<00:40,  9.80it/s, loss:1.89924]Epoch 1/12:   7%|▋         | 30/420 [00:03<00:40,  9.74it/s, loss:1.89924]Epoch 1/12:   7%|▋         | 30/420 [00:03<00:40,  9.74it/s, loss:1.92913]Epoch 1/12:   8%|▊         | 35/420 [00:03<00:38, 10.08it/s, loss:1.92913]Epoch 1/12:   8%|▊         | 35/420 [00:03<00:38, 10.08it/s, loss:1.91593]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 21.49it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.85it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 20.97it/s][A
                                                   [A                                                                          Epoch 1/12:   8%|▊         | 35/420 [00:03<00:38, 10.08it/s, loss:1.91593]                                                                          Epoch 1/12:   8%|▊         | 35/420 [00:04<00:38, 10.08it/s, loss:1.91593]                                                                          Epoch 1/12:   8%|▊         | 35/420 [00:04<00:38, 10.08it/s, loss:1.91593]/home/rockyo/anaconda3/envs/aicup/lib/python3.7/site-packages/torch/optim/lr_scheduler.py:154: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch 2/12:   8%|▊         | 35/420 [00:04<00:38, 10.08it/s, loss:1.91593]Epoch 2/12:  10%|▉         | 40/420 [00:04<00:52,  7.21it/s, loss:1.91593]Epoch 2/12:  10%|▉         | 40/420 [00:04<00:52,  7.21it/s, loss:1.88710]Epoch 2/12:  11%|█         | 45/420 [00:05<00:47,  7.85it/s, loss:1.88710]Epoch 2/12:  11%|█         | 45/420 [00:05<00:47,  7.85it/s, loss:1.90937]Epoch 2/12:  12%|█▏        | 50/420 [00:05<00:44,  8.32it/s, loss:1.90937]Epoch 2/12:  12%|█▏        | 50/420 [00:05<00:44,  8.32it/s, loss:1.87808]Epoch 2/12:  13%|█▎        | 55/420 [00:06<00:41,  8.72it/s, loss:1.87808]Epoch 2/12:  13%|█▎        | 55/420 [00:06<00:41,  8.72it/s, loss:1.87585]Epoch 2/12:  14%|█▍        | 60/420 [00:06<00:39,  9.04it/s, loss:1.87585]Epoch 2/12:  14%|█▍        | 60/420 [00:06<00:39,  9.04it/s, loss:1.86146]Epoch 2/12:  15%|█▌        | 65/420 [00:07<00:38,  9.19it/s, loss:1.86146]Epoch 2/12:  15%|█▌        | 65/420 [00:07<00:38,  9.19it/s, loss:1.89125]Epoch 2/12:  17%|█▋        | 70/420 [00:07<00:36,  9.59it/s, loss:1.89125]Epoch 2/12:  17%|█▋        | 70/420 [00:07<00:36,  9.59it/s, loss:1.91664]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 21.52it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.72it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 20.85it/s][A
                                                   [A                                                                          Epoch 2/12:  17%|█▋        | 70/420 [00:08<00:36,  9.59it/s, loss:1.91664]                                                                          Epoch 2/12:  17%|█▋        | 70/420 [00:08<00:36,  9.59it/s, loss:1.91664]                                                                          Epoch 2/12:  17%|█▋        | 70/420 [00:08<00:36,  9.59it/s, loss:1.91664]Epoch 3/12:  17%|█▋        | 70/420 [00:08<00:36,  9.59it/s, loss:1.91664]Epoch 3/12:  18%|█▊        | 75/420 [00:08<00:48,  7.05it/s, loss:1.91664]Epoch 3/12:  18%|█▊        | 75/420 [00:08<00:48,  7.05it/s, loss:1.87080]Epoch 3/12:  19%|█▉        | 80/420 [00:09<00:44,  7.61it/s, loss:1.87080]Epoch 3/12:  19%|█▉        | 80/420 [00:09<00:44,  7.61it/s, loss:1.90489]Epoch 3/12:  20%|██        | 85/420 [00:09<00:40,  8.24it/s, loss:1.90489]Epoch 3/12:  20%|██        | 85/420 [00:09<00:40,  8.24it/s, loss:1.89615]Epoch 3/12:  21%|██▏       | 90/420 [00:10<00:38,  8.61it/s, loss:1.89615]Epoch 3/12:  21%|██▏       | 90/420 [00:10<00:38,  8.61it/s, loss:1.89455]Epoch 3/12:  23%|██▎       | 95/420 [00:10<00:36,  8.95it/s, loss:1.89455]Epoch 3/12:  23%|██▎       | 95/420 [00:10<00:36,  8.95it/s, loss:1.87009]Epoch 3/12:  24%|██▍       | 100/420 [00:11<00:34,  9.15it/s, loss:1.87009]Epoch 3/12:  24%|██▍       | 100/420 [00:11<00:34,  9.15it/s, loss:1.84935]Epoch 3/12:  25%|██▌       | 105/420 [00:11<00:32,  9.56it/s, loss:1.84935]Epoch 3/12:  25%|██▌       | 105/420 [00:11<00:32,  9.56it/s, loss:1.81265]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 21.37it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.74it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 20.94it/s][A
                                                   [A                                                                           Epoch 3/12:  25%|██▌       | 105/420 [00:12<00:32,  9.56it/s, loss:1.81265]                                                                           Epoch 3/12:  25%|██▌       | 105/420 [00:12<00:32,  9.56it/s, loss:1.81265]                                                                           Epoch 3/12:  25%|██▌       | 105/420 [00:12<00:32,  9.56it/s, loss:1.81265]Epoch 4/12:  25%|██▌       | 105/420 [00:12<00:32,  9.56it/s, loss:1.81265]Epoch 4/12:  26%|██▌       | 110/420 [00:12<00:43,  7.15it/s, loss:1.81265]Epoch 4/12:  26%|██▌       | 110/420 [00:12<00:43,  7.15it/s, loss:1.86937]Epoch 4/12:  27%|██▋       | 115/420 [00:13<00:39,  7.76it/s, loss:1.86937]Epoch 4/12:  27%|██▋       | 115/420 [00:13<00:39,  7.76it/s, loss:1.82693]Epoch 4/12:  29%|██▊       | 120/420 [00:14<00:36,  8.22it/s, loss:1.82693]Epoch 4/12:  29%|██▊       | 120/420 [00:14<00:36,  8.22it/s, loss:2.01167]Epoch 4/12:  30%|██▉       | 125/420 [00:14<00:34,  8.65it/s, loss:2.01167]Epoch 4/12:  30%|██▉       | 125/420 [00:14<00:34,  8.65it/s, loss:1.87918]Epoch 4/12:  31%|███       | 130/420 [00:15<00:32,  8.91it/s, loss:1.87918]Epoch 4/12:  31%|███       | 130/420 [00:15<00:32,  8.91it/s, loss:1.82401]Epoch 4/12:  32%|███▏      | 135/420 [00:15<00:31,  9.10it/s, loss:1.82401]Epoch 4/12:  32%|███▏      | 135/420 [00:15<00:31,  9.10it/s, loss:1.86047]Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.52it/s, loss:1.86047]Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.52it/s, loss:1.69668]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 21.47it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.80it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 20.97it/s][A
                                                   [A                                                                           Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.52it/s, loss:1.69668]                                                                           Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.52it/s, loss:1.69668]                                                                           Epoch 4/12:  33%|███▎      | 140/420 [00:16<00:29,  9.52it/s, loss:1.69668]Epoch 5/12:  33%|███▎      | 140/420 [00:16<00:29,  9.52it/s, loss:1.69668]Epoch 5/12:  35%|███▍      | 145/420 [00:17<00:39,  7.01it/s, loss:1.69668]Epoch 5/12:  35%|███▍      | 145/420 [00:17<00:39,  7.01it/s, loss:1.79884]Epoch 5/12:  36%|███▌      | 150/420 [00:17<00:35,  7.70it/s, loss:1.79884]Epoch 5/12:  36%|███▌      | 150/420 [00:17<00:35,  7.70it/s, loss:1.80434]Epoch 5/12:  37%|███▋      | 155/420 [00:18<00:32,  8.22it/s, loss:1.80434]Epoch 5/12:  37%|███▋      | 155/420 [00:18<00:32,  8.22it/s, loss:1.85545]Epoch 5/12:  38%|███▊      | 160/420 [00:18<00:30,  8.63it/s, loss:1.85545]Epoch 5/12:  38%|███▊      | 160/420 [00:18<00:30,  8.63it/s, loss:1.81353]Epoch 5/12:  39%|███▉      | 165/420 [00:19<00:28,  8.97it/s, loss:1.81353]Epoch 5/12:  39%|███▉      | 165/420 [00:19<00:28,  8.97it/s, loss:1.79750]Epoch 5/12:  40%|████      | 170/420 [00:19<00:27,  9.15it/s, loss:1.79750]Epoch 5/12:  40%|████      | 170/420 [00:19<00:27,  9.15it/s, loss:1.69883]Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:25,  9.55it/s, loss:1.69883]Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:25,  9.55it/s, loss:1.89058]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 21.57it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.79it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 20.97it/s][A
                                                   [A                                                                           Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:25,  9.55it/s, loss:1.89058]                                                                           Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:25,  9.55it/s, loss:1.89058]                                                                           Epoch 5/12:  42%|████▏     | 175/420 [00:20<00:25,  9.55it/s, loss:1.89058]Epoch 6/12:  42%|████▏     | 175/420 [00:20<00:25,  9.55it/s, loss:1.89058]Epoch 6/12:  43%|████▎     | 180/420 [00:21<00:33,  7.14it/s, loss:1.89058]Epoch 6/12:  43%|████▎     | 180/420 [00:21<00:33,  7.14it/s, loss:1.80596]Epoch 6/12:  44%|████▍     | 185/420 [00:21<00:30,  7.78it/s, loss:1.80596]Epoch 6/12:  44%|████▍     | 185/420 [00:21<00:30,  7.78it/s, loss:1.77631]Epoch 6/12:  45%|████▌     | 190/420 [00:22<00:27,  8.32it/s, loss:1.77631]Epoch 6/12:  45%|████▌     | 190/420 [00:22<00:27,  8.32it/s, loss:1.65223]Epoch 6/12:  46%|████▋     | 195/420 [00:22<00:25,  8.71it/s, loss:1.65223]Epoch 6/12:  46%|████▋     | 195/420 [00:22<00:25,  8.71it/s, loss:1.60586]Epoch 6/12:  48%|████▊     | 200/420 [00:23<00:24,  8.92it/s, loss:1.60586]Epoch 6/12:  48%|████▊     | 200/420 [00:23<00:24,  8.92it/s, loss:1.87549]Epoch 6/12:  49%|████▉     | 205/420 [00:23<00:23,  9.07it/s, loss:1.87549]Epoch 6/12:  49%|████▉     | 205/420 [00:23<00:23,  9.07it/s, loss:1.57123]Epoch 6/12:  50%|█████     | 210/420 [00:24<00:22,  9.45it/s, loss:1.57123]Epoch 6/12:  50%|█████     | 210/420 [00:24<00:22,  9.45it/s, loss:1.89349]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 21.60it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.83it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 20.97it/s][A
                                                   [A                                                                           Epoch 6/12:  50%|█████     | 210/420 [00:24<00:22,  9.45it/s, loss:1.89349]                                                                           Epoch 6/12:  50%|█████     | 210/420 [00:24<00:22,  9.45it/s, loss:1.89349]                                                                           Epoch 6/12:  50%|█████     | 210/420 [00:24<00:22,  9.45it/s, loss:1.89349]Epoch 7/12:  50%|█████     | 210/420 [00:24<00:22,  9.45it/s, loss:1.89349]Epoch 7/12:  51%|█████     | 215/420 [00:25<00:26,  7.59it/s, loss:1.89349]Epoch 7/12:  51%|█████     | 215/420 [00:25<00:26,  7.59it/s, loss:1.60107]Epoch 7/12:  52%|█████▏    | 220/420 [00:25<00:24,  8.13it/s, loss:1.60107]Epoch 7/12:  52%|█████▏    | 220/420 [00:25<00:24,  8.13it/s, loss:1.64662]Epoch 7/12:  54%|█████▎    | 225/420 [00:26<00:22,  8.53it/s, loss:1.64662]Epoch 7/12:  54%|█████▎    | 225/420 [00:26<00:22,  8.53it/s, loss:1.63571]Epoch 7/12:  55%|█████▍    | 230/420 [00:26<00:21,  8.86it/s, loss:1.63571]Epoch 7/12:  55%|█████▍    | 230/420 [00:26<00:21,  8.86it/s, loss:1.84388]Epoch 7/12:  56%|█████▌    | 235/420 [00:27<00:20,  9.07it/s, loss:1.84388]Epoch 7/12:  56%|█████▌    | 235/420 [00:27<00:20,  9.07it/s, loss:1.61072]Epoch 7/12:  57%|█████▋    | 240/420 [00:27<00:19,  9.29it/s, loss:1.61072]Epoch 7/12:  57%|█████▋    | 240/420 [00:27<00:19,  9.29it/s, loss:1.77368]Epoch 7/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.70it/s, loss:1.77368]Epoch 7/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.70it/s, loss:1.72362]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 21.47it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.72it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 20.82it/s][A
                                                   [A                                                                           Epoch 7/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.70it/s, loss:1.72362]                                                                           Epoch 7/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.70it/s, loss:1.72362]                                                                           Epoch 7/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.70it/s, loss:1.72362]Epoch 8/12:  58%|█████▊    | 245/420 [00:28<00:18,  9.70it/s, loss:1.72362]Epoch 8/12:  60%|█████▉    | 250/420 [00:29<00:21,  7.73it/s, loss:1.72362]Epoch 8/12:  60%|█████▉    | 250/420 [00:29<00:21,  7.73it/s, loss:1.73039]Epoch 8/12:  61%|██████    | 255/420 [00:29<00:20,  8.19it/s, loss:1.73039]Epoch 8/12:  61%|██████    | 255/420 [00:29<00:20,  8.19it/s, loss:1.64614]Epoch 8/12:  62%|██████▏   | 260/420 [00:30<00:18,  8.54it/s, loss:1.64614]Epoch 8/12:  62%|██████▏   | 260/420 [00:30<00:18,  8.54it/s, loss:1.76138]Epoch 8/12:  63%|██████▎   | 265/420 [00:30<00:17,  8.79it/s, loss:1.76138]Epoch 8/12:  63%|██████▎   | 265/420 [00:30<00:17,  8.79it/s, loss:1.43236]Epoch 8/12:  64%|██████▍   | 270/420 [00:31<00:16,  9.07it/s, loss:1.43236]Epoch 8/12:  64%|██████▍   | 270/420 [00:31<00:16,  9.07it/s, loss:1.56533]Epoch 8/12:  65%|██████▌   | 275/420 [00:31<00:15,  9.29it/s, loss:1.56533]Epoch 8/12:  65%|██████▌   | 275/420 [00:31<00:15,  9.29it/s, loss:1.60756]Epoch 8/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.73it/s, loss:1.60756]Epoch 8/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.73it/s, loss:1.71367]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 21.51it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.78it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 20.93it/s][A
                                                   [A                                                                           Epoch 8/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.73it/s, loss:1.71367]                                                                           Epoch 8/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.73it/s, loss:1.71367]                                                                           Epoch 8/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.73it/s, loss:1.71367]Epoch 9/12:  67%|██████▋   | 280/420 [00:32<00:14,  9.73it/s, loss:1.71367]Epoch 9/12:  68%|██████▊   | 285/420 [00:33<00:17,  7.69it/s, loss:1.71367]Epoch 9/12:  68%|██████▊   | 285/420 [00:33<00:17,  7.69it/s, loss:1.61766]Epoch 9/12:  69%|██████▉   | 290/420 [00:33<00:15,  8.14it/s, loss:1.61766]Epoch 9/12:  69%|██████▉   | 290/420 [00:33<00:15,  8.14it/s, loss:1.70164]Epoch 9/12:  70%|███████   | 295/420 [00:34<00:14,  8.56it/s, loss:1.70164]Epoch 9/12:  70%|███████   | 295/420 [00:34<00:14,  8.56it/s, loss:1.53635]Epoch 9/12:  71%|███████▏  | 300/420 [00:34<00:13,  8.86it/s, loss:1.53635]Epoch 9/12:  71%|███████▏  | 300/420 [00:34<00:13,  8.86it/s, loss:1.55052]Epoch 9/12:  73%|███████▎  | 305/420 [00:35<00:12,  9.16it/s, loss:1.55052]Epoch 9/12:  73%|███████▎  | 305/420 [00:35<00:12,  9.16it/s, loss:1.65231]Epoch 9/12:  74%|███████▍  | 310/420 [00:35<00:11,  9.28it/s, loss:1.65231]Epoch 9/12:  74%|███████▍  | 310/420 [00:35<00:11,  9.28it/s, loss:1.65871]Epoch 9/12:  75%|███████▌  | 315/420 [00:36<00:10,  9.71it/s, loss:1.65871]Epoch 9/12:  75%|███████▌  | 315/420 [00:36<00:10,  9.71it/s, loss:1.47081]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 21.20it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.52it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 20.71it/s][A
                                                   [A                                                                           Epoch 9/12:  75%|███████▌  | 315/420 [00:36<00:10,  9.71it/s, loss:1.47081]                                                                           Epoch 9/12:  75%|███████▌  | 315/420 [00:36<00:10,  9.71it/s, loss:1.47081]                                                                           Epoch 9/12:  75%|███████▌  | 315/420 [00:36<00:10,  9.71it/s, loss:1.47081]Epoch 10/12:  75%|███████▌  | 315/420 [00:36<00:10,  9.71it/s, loss:1.47081]Epoch 10/12:  76%|███████▌  | 320/420 [00:37<00:12,  7.76it/s, loss:1.47081]Epoch 10/12:  76%|███████▌  | 320/420 [00:37<00:12,  7.76it/s, loss:1.61000]Epoch 10/12:  77%|███████▋  | 325/420 [00:37<00:11,  8.23it/s, loss:1.61000]Epoch 10/12:  77%|███████▋  | 325/420 [00:37<00:11,  8.23it/s, loss:1.57707]Epoch 10/12:  79%|███████▊  | 330/420 [00:38<00:10,  8.67it/s, loss:1.57707]Epoch 10/12:  79%|███████▊  | 330/420 [00:38<00:10,  8.67it/s, loss:1.50694]Epoch 10/12:  80%|███████▉  | 335/420 [00:38<00:09,  8.90it/s, loss:1.50694]Epoch 10/12:  80%|███████▉  | 335/420 [00:38<00:09,  8.90it/s, loss:1.42961]Epoch 10/12:  81%|████████  | 340/420 [00:39<00:08,  9.02it/s, loss:1.42961]Epoch 10/12:  81%|████████  | 340/420 [00:39<00:08,  9.02it/s, loss:1.99556]Epoch 10/12:  82%|████████▏ | 345/420 [00:39<00:08,  9.18it/s, loss:1.99556]Epoch 10/12:  82%|████████▏ | 345/420 [00:39<00:08,  9.18it/s, loss:1.66913]Epoch 10/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.58it/s, loss:1.66913]Epoch 10/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.58it/s, loss:1.57333]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 21.32it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.62it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 20.70it/s][A
                                                   [A                                                                            Epoch 10/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.58it/s, loss:1.57333]                                                                            Epoch 10/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.58it/s, loss:1.57333]                                                                            Epoch 10/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.58it/s, loss:1.57333]Epoch 11/12:  83%|████████▎ | 350/420 [00:40<00:07,  9.58it/s, loss:1.57333]Epoch 11/12:  85%|████████▍ | 355/420 [00:41<00:08,  7.70it/s, loss:1.57333]Epoch 11/12:  85%|████████▍ | 355/420 [00:41<00:08,  7.70it/s, loss:1.70340]Epoch 11/12:  86%|████████▌ | 360/420 [00:41<00:07,  8.19it/s, loss:1.70340]Epoch 11/12:  86%|████████▌ | 360/420 [00:41<00:07,  8.19it/s, loss:1.69533]Epoch 11/12:  87%|████████▋ | 365/420 [00:42<00:06,  8.46it/s, loss:1.69533]Epoch 11/12:  87%|████████▋ | 365/420 [00:42<00:06,  8.46it/s, loss:1.42500]Epoch 11/12:  88%|████████▊ | 370/420 [00:42<00:05,  8.81it/s, loss:1.42500]Epoch 11/12:  88%|████████▊ | 370/420 [00:42<00:05,  8.81it/s, loss:1.38753]Epoch 11/12:  89%|████████▉ | 375/420 [00:43<00:04,  9.08it/s, loss:1.38753]Epoch 11/12:  89%|████████▉ | 375/420 [00:43<00:04,  9.08it/s, loss:1.63614]Epoch 11/12:  90%|█████████ | 380/420 [00:43<00:04,  9.24it/s, loss:1.63614]Epoch 11/12:  90%|█████████ | 380/420 [00:43<00:04,  9.24it/s, loss:1.48268]Epoch 11/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.59it/s, loss:1.48268]Epoch 11/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.59it/s, loss:1.63817]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 21.14it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.41it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 20.57it/s][A
                                                   [A                                                                            Epoch 11/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.59it/s, loss:1.63817]                                                                            Epoch 11/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.59it/s, loss:1.63817]                                                                            Epoch 11/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.59it/s, loss:1.63817]Epoch 12/12:  92%|█████████▏| 385/420 [00:44<00:03,  9.59it/s, loss:1.63817]Epoch 12/12:  93%|█████████▎| 390/420 [00:45<00:03,  7.65it/s, loss:1.63817]Epoch 12/12:  93%|█████████▎| 390/420 [00:45<00:03,  7.65it/s, loss:1.51406]Epoch 12/12:  94%|█████████▍| 395/420 [00:45<00:03,  8.15it/s, loss:1.51406]Epoch 12/12:  94%|█████████▍| 395/420 [00:45<00:03,  8.15it/s, loss:1.58040]Epoch 12/12:  95%|█████████▌| 400/420 [00:46<00:02,  8.59it/s, loss:1.58040]Epoch 12/12:  95%|█████████▌| 400/420 [00:46<00:02,  8.59it/s, loss:1.59241]Epoch 12/12:  96%|█████████▋| 405/420 [00:46<00:01,  8.94it/s, loss:1.59241]Epoch 12/12:  96%|█████████▋| 405/420 [00:46<00:01,  8.94it/s, loss:1.44708]Epoch 12/12:  98%|█████████▊| 410/420 [00:47<00:01,  9.17it/s, loss:1.44708]Epoch 12/12:  98%|█████████▊| 410/420 [00:47<00:01,  9.17it/s, loss:1.56918]Epoch 12/12:  99%|█████████▉| 415/420 [00:48<00:00,  9.26it/s, loss:1.56918]Epoch 12/12:  99%|█████████▉| 415/420 [00:48<00:00,  9.26it/s, loss:1.53856]Epoch 12/12: 100%|██████████| 420/420 [00:48<00:00,  9.55it/s, loss:1.53856]Epoch 12/12: 100%|██████████| 420/420 [00:48<00:00,  9.55it/s, loss:1.61053]
  0%|          | 0/9 [00:00<?, ?it/s][A
Test:   0%|          | 0/9 [00:00<?, ?it/s][A
Test:  33%|███▎      | 3/9 [00:00<00:00, 21.37it/s][A
Test:  67%|██████▋   | 6/9 [00:00<00:00, 20.63it/s][A
Test: 100%|██████████| 9/9 [00:00<00:00, 20.73it/s][A
                                                   [A                                                                            Epoch 12/12: 100%|██████████| 420/420 [00:48<00:00,  9.55it/s, loss:1.61053]                                                                            Epoch 12/12: 100%|██████████| 420/420 [00:48<00:00,  9.55it/s, loss:1.61053]                                                                            Epoch 12/12: 100%|██████████| 420/420 [00:48<00:00,  9.55it/s, loss:1.61053]                                                                            
AccuracyMetric: acc=0.507143
Acc_loss_Metric: val_loss=1.908337
ClassifyFPreRecMetric: f=0.382776, pre=0.333333, rec=0.449477

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 7/12. Step:245/420: 
AccuracyMetric: acc=0.507143
Acc_loss_Metric: val_loss=1.956226
ClassifyFPreRecMetric: f=0.378, pre=0.336806, rec=0.438121

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 8/12. Step:280/420: 
AccuracyMetric: acc=0.507143
Acc_loss_Metric: val_loss=1.858782
ClassifyFPreRecMetric: f=0.381749, pre=0.333478, rec=0.446638

Evaluate data in 0.42 seconds!
Evaluation on dev at Epoch 9/12. Step:315/420: 
AccuracyMetric: acc=0.514286
Acc_loss_Metric: val_loss=1.862631
ClassifyFPreRecMetric: f=0.382937, pre=0.342364, rec=0.443412

Evaluate data in 0.42 seconds!
Evaluation on dev at Epoch 10/12. Step:350/420: 
AccuracyMetric: acc=0.521429
Acc_loss_Metric: val_loss=1.88327
ClassifyFPreRecMetric: f=0.390036, pre=0.347854, rec=0.451542

Evaluate data in 0.42 seconds!
Evaluation on dev at Epoch 11/12. Step:385/420: 
AccuracyMetric: acc=0.507143
Acc_loss_Metric: val_loss=2.020631
ClassifyFPreRecMetric: f=0.380617, pre=0.334074, rec=0.443799

Evaluate data in 0.42 seconds!
Evaluation on dev at Epoch 12/12. Step:420/420: 
AccuracyMetric: acc=0.528571
Acc_loss_Metric: val_loss=2.121919
ClassifyFPreRecMetric: f=0.396658, pre=0.348148, rec=0.462511

Reloaded the best model.

In Epoch:4/Step:140, got best dev performance:
AccuracyMetric: acc=0.542857
Acc_loss_Metric: val_loss=1.771749
ClassifyFPreRecMetric: f=0.411891, pre=0.358346, rec=0.48445
Visualization...
[0, 2, 0, 2, 2, 0, 0, 0, 2, 2, 2, 2, 2, 0, 0, 2, 0, 2, 2, 0]
acc 0.5429
Predicting dev...
writing pred3.npy...
[34mAuto commit by fitlog[0m
--------Fold4----------
Found 7550 out of 10306 words in the pre-training embedding.
loading vocabulary file /home/rockyo/.fastNLP/embedding/bert-chinese-wwm-ext/vocab.txt
The transformer encoder will early exit after layer-1 (start from 0)!
Load pre-trained BERT parameters from file /home/rockyo/.fastNLP/embedding/bert-chinese-wwm-ext/pytorch_model.bin.
input fields after batch(if batch size is 2):
	raw_text: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 3, 169]) 
	cho: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 3, 21]) 
	q: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 12]) 
	target_onehot: (1)type:torch.Tensor (2)dtype:torch.float32, (3)shape:torch.Size([2, 3]) 
	roleid: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2, 3, 169]) 
	q_seq_len: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 
target fields after batch(if batch size is 2):
	target: (1)type:torch.Tensor (2)dtype:torch.int64, (3)shape:torch.Size([2]) 

training epochs started 2021-06-17-01-04-35-205851
Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 1/12. Step:35/420: 
AccuracyMetric: acc=0.41958
Acc_loss_Metric: val_loss=1.901749
ClassifyFPreRecMetric: f=0.31743, pre=0.300016, rec=0.384286

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 2/12. Step:70/420: 
AccuracyMetric: acc=0.447552
Acc_loss_Metric: val_loss=1.879331
ClassifyFPreRecMetric: f=0.338791, pre=0.294765, rec=0.39881

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 3/12. Step:105/420: 
AccuracyMetric: acc=0.475524
Acc_loss_Metric: val_loss=1.80625
ClassifyFPreRecMetric: f=0.365659, pre=0.328407, rec=0.430476

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 4/12. Step:140/420: 
AccuracyMetric: acc=0.517483
Acc_loss_Metric: val_loss=1.798779
ClassifyFPreRecMetric: f=0.397073, pre=0.359399, rec=0.469762

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 5/12. Step:175/420: 
AccuracyMetric: acc=0.531469
Acc_loss_Metric: val_loss=1.773544
ClassifyFPreRecMetric: f=0.406235, pre=0.364752, rec=0.483095

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 6/12. Step:210/420: 
AccuracyMetric: acc=0.51049
Acc_loss_Metric: val_loss=1.779607
ClassifyFPreRecMetric: f=0.390957, pre=0.35311, rec=0.46381

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 7/12. Step:245/420: 
AccuracyMetric: acc=0.517483
Acc_loss_Metric: val_loss=1.76895
ClassifyFPreRecMetric: f=0.394607, pre=0.362719, rec=0.471905

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 8/12. Step:280/420: 
AccuracyMetric: acc=0.475524
Acc_loss_Metric: val_loss=1.819445
ClassifyFPreRecMetric: f=0.356935, pre=0.380022, rec=0.438333

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 9/12. Step:315/420: 
AccuracyMetric: acc=0.482517
Acc_loss_Metric: val_loss=1.979656
ClassifyFPreRecMetric: f=0.365986, pre=0.335274, rec=0.441429

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 10/12. Step:350/420: 
AccuracyMetric: acc=0.482517
Acc_loss_Metric: val_loss=1.871307
ClassifyFPreRecMetric: f=0.36618, pre=0.334868, rec=0.440714

Evaluate data in 0.44 seconds!
Evaluation on dev at Epoch 11/12. Step:385/420: 
AccuracyMetric: acc=0.412587
Acc_loss_Metric: val_loss=2.075942
ClassifyFPreRecMetric: f=0.286067, pre=0.318891, rec=0.384762

Evaluate data in 0.43 seconds!
Evaluation on dev at Epoch 12/12. Step:420/420: 
AccuracyMetric: acc=0.426573
Acc_loss_Metric: val_loss=2.042275
ClassifyFPreRecMetric: f=0.297682, pre=0.315009, rec=0.397381

Reloaded the best model.

In Epoch:5/Step:175, got best dev performance:
AccuracyMetric: acc=0.531469
Acc_loss_Metric: val_loss=1.773544
ClassifyFPreRecMetric: f=0.406235, pre=0.364752, rec=0.483095
Visualization...
[2, 2, 0, 2, 0, 0, 2, 2, 2, 2, 2, 0, 0, 2, 2, 2, 0, 2, 0, 0]
acc 0.5315
Predicting dev...
writing pred4.npy...
